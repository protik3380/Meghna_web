@using System.Configuration
@using System.Globalization
@using EFreshStore.Models
@using EFreshStore.Models.Context
@using EFreshStore.Models.Context.EntityModels
@using EFreshStore.Models.Enum
@using EFreshStore.Models.ViewModels
@using EFreshStore.Utility
@using Vereyon.Web
﻿@using EFreshStore.Models.Context
@{

    long userTypeId = 0;
    if (Request.Cookies["username"] != null)
    {
        Session["email"] = Request.Cookies["username"].Value;
        var x = Session["email"];
    }
    if (Request.Cookies["usertypeid"] != null)
    {
        Session["UserTypeId"] = Request.Cookies["usertypeid"].Value;
    }
    if (Request.Cookies["userid"] != null)
    {
        Session["UserId"] = Request.Cookies["userid"].Value;
    }
    if (Request.Cookies["discountPercentage"] != null)
    {
        Session["discount"] = Request.Cookies["discountPercentage"].Value;
        var y = Session["discount"];
    }
    if (Request.Cookies["AccessToken"] != null)
    {
        LoginCredentials loginCredentials = new LoginCredentials
        {
            AccessToken = Request.Cookies["AccessToken"].Value,
            RefreshToken = Request.Cookies["RefreshToken"].Value,
            TokenType = Request.Cookies["TokenType"].Value,
            ExpiresIn = Convert.ToInt32(Request.Cookies["ExpiresIn"].Value),
            Error = Request.Cookies["Error"].Value
        };
        Session["userToken"] = loginCredentials;
    }
    List<CartView> cartDetails = new List<CartView>();
    int countItem = 0;
    decimal discount = 0;
    string totalAmount = "0";
    var isLogin = false;
    var realPrice = 0.0;
    var showCartPrice = 0.0;
    var Total = 0.0;
    var row = 0;
    decimal userDiscount = 0;
    var cartSubTotal = 0;
    if (Session["cartView"] != null)
    {
        cartDetails = (List<CartView>)Session["cartView"];
        ViewBag.cart = cartDetails;
        countItem = cartDetails.Count;
        Session["CountItem"] = cartDetails.Count;
        totalAmount = cartDetails.Sum(c => c.UnitPrice).ToString();
        cartSubTotal = (int)cartDetails.Sum(c => c.Price);
    }
    var userName = "";

    long userId = Convert.ToInt64(Session["UserId"]);
    if (Session["email"] != null)
    {
        userTypeId = Convert.ToInt64(Session["userTypeId"]);
        if (userTypeId == (long)UserTypeEnum.Corporate)
        {
            CorporateUser corporateUser = ApiUtility.GetCorporateUserByUserId(userId);
            userName = corporateUser.Name;
        }
        else if (userTypeId == (long)UserTypeEnum.MeghnaUser)
        {
            MeghnaUser meghnaUser = ApiUtility.GetMeghnaUserByUserId(userId);
            userName = meghnaUser.Name;
        }
        else
        {
            Customer customer = ApiUtility.GetCustomerByUserId(userId);
            userName = customer.Name;
        }
        isLogin = true;
        //userName = Session["email"].ToString();
        //discount = Convert.ToDecimal(Session["discount"]);
        //userDiscount = Convert.ToDecimal(Session["discount"]);
    }
    List<Brand> brands = Dropdown.Brands();
    List<Category> categories = Dropdown.Categories();

}

<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        .error {
            color: red;
            padding: 0;
            font-weight: normal;
        }
    </style>
    <!-- Basic page needs -->
    <meta charset="utf-8">
    <!--[if IE]>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <![endif]-->
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>E-Fresh Store</title>
    @*<meta name="description" content="best ecommerce, template free, responsive theme, fashion store, responsive theme, responsive html theme, Premium website templates, web templates, Multi-Purpose Responsive HTML5 Template">
        <meta name="keywords" content="bootstrap, ecommerce, fashion, layout, responsive, responsive template, responsive template download, responsive theme, retail, shop, shopping, store, Premium website templates, web templates, Multi-Purpose Responsive HTML5 Template" />*@

    <!-- Mobile specific metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon -->
    @*<link rel="shortcut icon" type="image/x-icon" href="~/Content/images/favicon.ico">*@
    <link rel="shortcut icon" type="image/x-icon" href="~/Content/images/logo/FreshLogoIcon48.png">

    <!-- CSS Style -->
    <link href="~/Content/css/PlayStoreButton.css" rel="stylesheet" />
    <link href="~/Content/css/userLoginOption.css" rel="stylesheet" />
    <link href="~/Content/css/discount.css" rel="stylesheet" />
    <link href="~/Content/css/animate.css" rel="stylesheet" />
    <link href="~/Content/css/blog.css" rel="stylesheet" />
    <link href="~/Content/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/css/flexslider.css" rel="stylesheet" />
    <link href="~/Content/css/font-awesome.min.css" rel="stylesheet" />
    <link href="~/Content/css/jquery-ui.min.css" rel="stylesheet" />
    <link href="~/Content/css/jtv-mobile-Menu.css" rel="stylesheet" />
    <link href="~/Content/css/meanMenu.min.css" rel="stylesheet" />
    <link href="~/Content/css/nivo-slider.css" rel="stylesheet" />
    <link href="~/Content/css/owl.carousel.css" rel="stylesheet" />
    <link href="~/Content/css/owl.transitions.css" rel="stylesheet" />
    <link href="~/Content/css/pe-icon-7-stroke.min.css" rel="stylesheet" />
    <link href="~/Content/css/quick_view_popup.css" rel="stylesheet" />
    <link href="~/Content/css/responsive.css" rel="stylesheet" />
    <link href="~/Content/css/revolution-slider.css" rel="stylesheet" />
    <link href="~/Content/css/simple-line-icons.css" rel="stylesheet" />
    <link href="~/Content/css/slick.min.css" rel="stylesheet" />
    <link href="~/Content/css/toastr.css" rel="stylesheet" />
    <link href="~/Content/css/typeahead.css" rel="stylesheet" />
    <link href="~/Content/css/star-rating.min.css" rel="stylesheet" />
    <link href="~/Content/css/style.css" rel="stylesheet" />
    <link href="~/Content/style.css" rel="stylesheet" />
    <link href="~/Content/css/OrderHistory.css" rel="stylesheet" />
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    @RenderSection("style", required: false)
</head>
<body class="cms-index-index cms-home-page">
    <div id="preloader">
        <div class="blur"></div>
        <div class="sk-three-bounce">
            <div class="sk-child sk-bounce1"></div>
            <div class="sk-child sk-bounce2"></div>
            <div class="sk-child sk-bounce3"></div>
        </div>
    </div>

    <div id="page">

        <!-- Header -->
        <header id="header">
            <div class="header-container">
                <div class="header-top">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-5 col-sm-5 col-xs-6 hidden-xs"> <span class="phone hidden-xs"><i class="fa fa-phone fa-lg"></i> <span class="hidden-sm">Any question? Call Us </span> +880-1713-191921</span> </div>
                            <!-- top links -->
                            <div class="headerlinkmenu col-md-7 col-sm-7 col-xs-12">
                                <ul class="links">
                                    <li><a href="@Url.Action("Checkout", "Order")">Checkout</a></li>

                                    @if (Session["UserId"] != null)
                                    {
                                        <li><a href="@Url.Action("Logout", "Home")">Log Out</a></li>
                                    }
                                    else
                                    {
                                        <li><a href="@Url.Action("Create", "Customer")">Sign Up</a></li>
                                        <li><a href="@Url.Action("Login", "Home")">Log In</a></li>
                                    }

                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container">
                    <div class="row">
                        <!-- Header Logo -->
                        <div class="col-xs-12 col-lg-5 col-md-3 col-sm-3">
                            <div class="logo">
                                <a title="e-commerce" href="@Url.Action("Index", "Home")"><img alt="E-Fresh Store Logo" src="~/Content/images/logo/logo.png"></a>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-5 col-md-6 col-md-5">
                            <!-- Search -->
                            <div id="search">
                                <form class="header-search-form" action="@Url.Action("Search", "Home")" method="GET">
                                    <div class="input-group">
                                        <input class="form-control" type="text" id="searchString" name="q" value="@(ViewBag.SearchTerm != null ? ViewBag.SearchTerm.ToString() : "")" placeholder="Search..." />
                                        <button class="btn-search" type="submit"><i class="fa fa-search"></i></button>
                                    </div>
                                </form>
                            </div>
                            @*<div id="nav-search">
                                    <form class="header-search-form" action="@Url.Action("Search", "Home")" method="GET">
                                        <div class="tt-container">
                                            <div class="form-group">
                                                <div class="input-group">
                                                    <input type="text" class="form-control" id="searchString" name="searchString" placeholder="Search..">
                                                    <div class="input-group-addon"><button type="submit" class="btn-search"><i class="fa fa-search"></i></button></div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>*@
                            @*<form class="form-inline">
                                    <div class="form-group">
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="exampleInputAmount" placeholder="Amount">
                                            <div class="input-group-addon"><button type="submit" class="btn-search"><i class="fa fa-search"></i></button></div>
                                        </div>
                                    </div>

                                </form>*@
                            <!-- End Search -->
                        </div>
                        <div class="col-lg-2 col-sm-3 col-xs-12 top-cart">
                            @if (Session["email"] != null)
                            {
                                <div class="main-menu" style="float: right; border-style: none;border: 0 solid red;">
                                    <ul class="hidden-xs" style="border-style: none;border: 0 solid red;">
                                        <li style="border-style: none;border: 0 solid red;">
                                            <i class="fa fa-user" style="font-size: 14px; background: white; padding: 16px 17px 16px 17px; border-radius: 50%;border-style: none;border: 0 solid red;cursor: pointer"></i>
                                            <ul class="dropdown" style="width:auto">
                                                <li>
                                                    <a href="@Url.Action("ViewUser", "Contract")">
                                                        <span style="float: left; left: -6px;top:10px"><img src="~/Content/images/icon/eFresh-User-Icon.png" style="height: 30px; width: 30px;" />&nbsp;&nbsp;</span>Welcome,<br />@userName<hr style="color: black" />
                                                    </a>

                                                </li>
                                                @*<li><a href="@Url.Action("ViewUser", "Contract")">My Profile</a></li>*@
                                                <li><a href="@Url.Action("Index", "WishList")">My Wish List</a></li>
                                                <li><a href="@Url.Action("MyOrders", "Order")">My Orders</a></li>
                                                <li><a href="@Url.Action("ChangePassword", "Home")">Change Password</a></li>
                                                <li>
                                                    <a href="@Url.Action("Logout", "Home")">Logout</a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>

                            }
                            else
                            {
                                <a href="@Url.Action("Login", "Home")" class="top-my-account"><i class="fa fa-user"></i></a>
                            }
                        </div>
                    </div>
                </div>
            </div>
            <nav>
                <div class="menu-area">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="main-menu">
                                    <div class="mm-toggle-wrap hidden-lg hidden-md hidden-sm">
                                        <div class="mm-toggle"> <i class="fa fa-align-justify"></i><span class="mm-label">Menu</span> </div>
                                    </div>
                                    <div>
                                        <ul class="hidden-xs">
                                            <li id="home" class="active custom-menu">
                                                <a href="@Url.Action("Index", "Home")">Home</a>
                                            </li>
                                            <li id="category" class="custom-menu">
                                                <a href="#">Categories</a>
                                                <ul class="dropdown">
                                                    @if (categories != null)
                                                    {
                                                        foreach (var category in categories)
                                                        {
                                                            @*<li><a href="@Url.Action("Search", "Home", new {categoryId = category.Id})">@category.Name @*<span class="menu-item-tag menu-item-tag-hot">hot</span></a></li>*@
                                                            <li><a href="~/search/category/@category.Id">@category.Name </a></li>
                                                        }
                                                    }
                                                </ul>
                                            </li>

                                            <li id="brand">
                                                <a href="#">Brands</a>
                                                <div class="mega-menu" style="width: 60%">
                                                    <div class="menu-block">
                                                        <div class="menu-block-1">
                                                            @if (brands != null)
                                                            {
                                                                foreach (var brand in brands)
                                                                {
                                                                    <ul>

                                                                        @{
                                                                            if (brand.brandImage == null)
                                                                            {
                                                                                brand.brandImage = "/Content/img/product/NoProductImage.png";
                                                                            }
                                                                            <li><a href="~/search/brand/@brand.Id"><img src="@BaseUrl.baseUrl\@brand.brandImage" alt="@brand.Name"></a></li>
                                                                            <li> <a class="mega-title" href="~/search/brand/@brand.Id">@brand.Name @*<span class="menu-item-tag menu-item-tag-hot">hot</span>*@</a></li>
                                                                        }
                                                                    </ul>
                                                                                }
                                                                            }

                                                        </div>
                                                    </div>
                                                </div>
                                            </li>
                                            <li id="contactUs"><a href="@Url.Action("ContactUs", "Home")">Contact</a></li>

                                        </ul>
                                        <ul style="float: right;">
                                            <li id="trackOrder"><a href="@Url.Action("TrackOrder", "Home")">Track Your Order</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </header>
        <!-- end header -->
        @*@if (cartDetails != null)
            {
                foreach (var item in cartDetails)
                {
                    ProductDiscount productDiscount = ApiUtility.GetProductDiscountByProductUnitID(@item.ProductUnitId);

                    decimal SpecificDiscount = Convert.ToDecimal(productDiscount.DiscountPercentage);
                    if (@userTypeId == (long)UserTypeEnum.MeghnaUser)
                    {
                        realPrice = item.DistributorPrice;
                        totalAmount += Convert.ToDecimal(realPrice);
                        Total = Total + realPrice;
                        item.Price = realPrice;
                    }
                    else
                    {
                        if (SpecificDiscount > 0 && productDiscount.Validity > DateTime.Now)
                        {
                            if (userDiscount > SpecificDiscount)
                            {
                                //realPrice = (@item.Price*100)/(100 - (double)SpecificDiscount);
                                realPrice = item.UnitPrice - ((item.UnitPrice * (double)userDiscount) / 100);
                                totalAmount += Convert.ToDecimal(realPrice);
                                showCartPrice = (item.UnitPrice - ((item.UnitPrice * (double)SpecificDiscount) / 100));
                                Total = Total + showCartPrice;
                                item.Price = realPrice;
                            }
                            else
                            {
                                realPrice = item.UnitPrice - ((item.UnitPrice * (double)SpecificDiscount) / 100);
                                showCartPrice = realPrice;
                                totalAmount += Convert.ToDecimal(realPrice);
                                Total = Total + realPrice;
                                item.Price = realPrice;
                            }
                        }
                        else if (userDiscount > (decimal)0.0)
                        {
                            showCartPrice = item.UnitPrice;
                            realPrice = item.UnitPrice - ((item.UnitPrice * (double)userDiscount) / 100);
                            totalAmount += Convert.ToDecimal(realPrice);
                            Total = Total + item.UnitPrice;
                            item.Price = realPrice;
                        }
                        else
                        {
                            showCartPrice = item.UnitPrice;
                            realPrice = item.UnitPrice;
                            totalAmount += Convert.ToDecimal(realPrice);
                            Total = Total + realPrice;
                            item.Price = realPrice;
                        }
                    }
                    var unitPrice = Convert.ToDecimal(realPrice).ToString("N", CultureInfo.CreateSpecificCulture("bn-BD"));



                }
            }*@

        @if (isLogin)
        {

        }
        else
        {
            <ul id="menu">
                <li>
                    <a>Login <br /><span onclick="goToLogin()">For Discount</span></a>
                </li>
            </ul>
        }

        @RenderBody()
        <!-- service section start -->
        <div class="container">
            <div class="jtv-service-area">
                <div class="row">
                    <div class="col col-md-4 col-sm-4 col-xs-12 no-padding">
                        <div class="block-wrapper ship">
                            <div class="text-des">
                                <i class="icon-rocket"></i>
                                <h3>FREE SHIPPING & RETURN</h3>
                                <p>Lorem ipsum dolor sit amet.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col col-md-4 col-sm-4 col-xs-12 no-padding">
                        <div class="block-wrapper return">
                            <div class="text-des">
                                <i class="fa fa-dollar"></i>
                                <h3>MONEY BACK GUARANTEE</h3>
                                <p>Lorem ipsum dolor sit amet.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col col-md-4 col-sm-4 col-xs-12 no-padding">
                        <div class="block-wrapper support">
                            <div class="text-des">
                                <i class="fa fa-headphones"></i>
                                <h3>ONLINE SUPPORT 24/7</h3>
                                <p>Lorem ipsum dolor sit amet. </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- service section end-->
        <!-- our clients Slider -->
        <div class="our-clients">
            <div class="container">
                <div class="slider-items-products">
                    <div id="our-clients-slider" class="product-flexslider hidden-buttons">
                        <div class="slider-items slider-width-col6">

                            <!-- Item -->
                            <div class="item"> <a href="#"><img src="~/content/images/brand1.png" alt="Image" class="grayscale"></a> </div>
                            <!-- End Item -->
                            <!-- Item -->
                            <div class="item"> <a href="#"><img src="~/content/images/brand2.png" alt="Image" class="grayscale"></a> </div>
                            <!-- End Item -->
                            <!-- Item -->
                            <div class="item"> <a href="#"><img src="~/content/images/brand3.png" alt="Image" class="grayscale"></a> </div>
                            <!-- End Item -->
                            <!-- Item -->
                            <div class="item"> <a href="#"><img src="~/content/images/brand4.png" alt="Image" class="grayscale"></a> </div>
                            <!-- End Item -->
                            <!-- Item -->
                            <div class="item"> <a href="#"><img src="~/content/images/brand5.png" alt="Image" class="grayscale"></a> </div>
                            <!-- End Item -->
                            <!-- Item -->
                            <div class="item"> <a href="#"><img src="~/content/images/brand6.png" alt="Image" class="grayscale"></a> </div>
                            <!-- End Item -->
                            <!-- Item -->
                            <div class="item"> <a href="#"><img src="~/content/images/brand7.png" alt="Image" class="grayscale"></a> </div>
                            <!-- End Item -->

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- End our clients Slider -->
        <!-- Footer -->
        @*if (@userTypeId == (long)UserTypeEnum.Corporate)
            {
                <div id="modal-container">
                    <div class="modal-background">
                        <div class="modal">
                            <h2>Dear Customer ! <span style='font-size: 50px;'>&#9819;</span></h2>
                            <p>You have @discount % Discount on every purchase.</p>
                            <svg class="modal-svg" xmlns="http://www.w3.org/2000/svg" width="50%" height="50%" preserveAspectRatio="none">
                                <rect x="0" y="0" fill="none" width="100%" height="100%" rx="3" ry="3"></rect>
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="buttons">
                    <i id="six" class='fa fa-gift button'>
                        @{
                            string discountpercent = string.Format("{0:0}", @discount);
                        }
                        <p style="font-size: 14px; font-weight: bold">@discountpercent% OFF</p>
                    </i>
                </div>
            }
            else if (@userTypeId == (long)UserTypeEnum.MeghnaUser)
            {
                            <div id="modal-container">
                                <div class="modal-background">
                                    <div class="modal">
                                        <h2>Dear Customer ! <span style='font-size: 50px;'>&#9819;</span></h2>
                                        <p>As a MGI user you will get</p>
                                        <p>distributor price on every purchase.</p>
                                        <svg class="modal-svg" xmlns="http://www.w3.org/2000/svg" width="50%" height="50%" preserveAspectRatio="none">
                                            <rect x="0" y="0" fill="none" width="100%" height="100%" rx="3" ry="3"></rect>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                            <div class="buttons">
                                <i id="six" class='fa fa-gift button'>
                                    @{
                                        string discountpercent = string.Format("{0:0}", @discount);
                                    }
                                    <p style="font-size: 14px; font-weight: bold">Distributor<br/> Price</p>
                                </i>
                            </div>
            }*@


        <div class="loginFloatBox" id="loginFloatBox">
            <div class="FloatBox" id="FloatBox" data-toggle="modal" data-target="#modal-cart">
                <ul class="tags">
                    <li style="background: #02568a; color: white; padding: 5px 0 0 0;">
                        <a href="#" class="box" style="background: transparent; color: white; font-size: 11px">
                            <i class="fa fa-shopping-bag" style="font-size: 36px;"></i><br />
                            <div style="position: relative; top: -11px; right: 1px" id="CartCountItem"></div>ITEMS
                        </a>
                    </li>
                    <li style="background: #ddd; color: black; padding: 4px 0 4px 0; font-weight: bold"><a href="#" class="box" style="background: transparent"><span id="subTotalInCart"></span></a></li>
                </ul>
            </div>
        </div>

        <footer>

            <div class="footer-newsletter">
                <div class="container">



                    <div class="row">
                        <div class="col-md-3 col-sm-5">
                            <h3 class="">Sign up for newsletter</h3>
                        </div>
                        <div class="col-md-5 col-sm-7">
                            <form id="newsletter-validate-detail" method="post" action="@Url.Action("Subscribe","Subscriber")">
                                <div class="newsletter-inner">
                                    <input class="newsletter-email" type="text" id="SubEmail" name="SubEmail" placeholder="Enter your email" />
                                    <button class="button subscribe" type="submit" title="Subscribe">Subscribe</button>
                                </div>
                                <div id="newsletter-validate-message"></div>
                            </form>
                        </div>
                        <div class="col-md-4 col-sm-12">
                            <div class="social">
                                <ul class="inline-mode">
                                    <li class="social-network fb"><a title="Connect us on Facebook" target="_blank" href="#"><i class="fa fa-facebook"></i></a></li>
                                    <li class="social-network googleplus"><a title="Connect us on Google+" target="_blank" href="#"><i class="fa fa-google-plus"></i></a></li>
                                    <li class="social-network tw"><a title="Connect us on Twitter" target="_blank" href="#"><i class="fa fa-twitter"></i></a></li>
                                    <li class="social-network linkedin"><a title="Connect us on Linkedin" target="_blank" href="#"><i class="fa fa-linkedin"></i></a></li>
                                    <li class="social-network rss"><a title="Connect us on Instagram" target="_blank" href="#"><i class="fa fa-rss"></i></a></li>
                                    <li class="social-network instagram"><a title="Connect us on Instagram" target="_blank" href="#"><i class="fa fa-instagram"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-sm-6 col-md-4 col-xs-12 col-lg-3">
                        <div class="footer-logo">
                            <a href="#"><img src="~/Content/images/logo/logo.png" alt="fotter logo"></a>
                        </div>
                        <div class="footer-content">
                            <div class="email">
                                <i class="fa fa-envelope"></i>
                                <p>info@meghnagroup.biz</p>
                            </div>
                            <div class="phone">
                                <i class="fa fa-phone"></i>
                                <p>+88 017 14166870</p>
                            </div>
                            <div class="address">
                                <i class="fa fa-map-marker"></i>
                                <p>Fresh Cottage, H#48, S#13, Dhaka-1230, Bangladesh</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-md-3 col-xs-12 col-lg-3 collapsed-block">
                        <div class="footer-links">
                            <h3 class="links-title">
                                Information<a class="expander visible-xs" href="#TabBlock-1">+</a>
                            </h3>
                            <div class="tabBlock" id="TabBlock-1">
                                <ul class="list-links list-unstyled">
                                    <li><a href="#">Contact Us</a></li>
                                    <li><a href="#">Privacy Policy</a></li>
                                    <li id="faq"><a href="@Url.Action("Faq", "Home")">FAQ</a></li>
                                    <li><a href="#">Terms &amp; Condition</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-md-5 col-xs-12 collapsed-block">
                        <div class="footer-links">
                            <h3 class="links-title">
                                Download Our App on<a class="expander visible-xs" href="#TabBlock-3">+</a>
                            </h3>
                            <div class="tabBlock" id="TabBlock-3">
                                <a href="#">
                                    <img id="googlePlayButton" alt="google-play" src="~/Content/images/logo/Google-play.png"
                                         onmouseover="this.src = '/Content/images/logo/Google-play-hover.png'"
                                         onmouseout="this.src = '/Content/images/logo/Google-play.png'"
                                         alt="google-play" />
                                </a>
                                @*<img src="~/Content/images/logo/Get-it-on-Google-play-2.png" />*@
                                @*<img src="~/Content/images/logo/Get-it-on-Google-play-2.png" />*@
                                <a href="#">
                                    <img src="~/Content/images/logo/App-store.png" id="apple-store"
                                         onmouseover="this.src = '/Content/images/logo/App-store-hover.png'"
                                         onmouseout="this.src = '/Content/images/logo/App-store.png'"
                                         alt="" />
                                </a>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="footer-coppyright">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-6 col-xs-12 coppyright">
                            Copyright © @DateTime.Now.Year <a href="https://www.meghnagroup.biz/" target="_blank"> Meghna Group</a>. All Rights Reserved.
                        </div>
                        <div class="col-sm-6 col-xs-12">
                            <div class="payment">
                                <ul>
                                    <li><a href="#"><img title="Visa" alt="Visa" src="~/Content/images/visa.png"></a></li>
                                    <li><a href="#"><img title="Paypal" alt="Paypal" src="~/Content/images/paypal.png"></a></li>
                                    <li><a href="#"><img title="Discover" alt="Discover" src="~/Content/images/discover.png"></a></li>
                                    <li><a href="#"><img title="Master Card" alt="Master Card" src="~/Content/images/master-card.png"></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <a href="#" id="back-to-top" title="Back to top"><i class="fa fa-angle-up"></i></a>
        <!-- End Footer -->

        <div id="modal-cart" class="modal modal-right fade" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                        <h4 class="modal-title" id="totalCartItems"><!-- Total cart items --></h4>
                    </div>
                    <div class="modal-footer" style="margin-top: 0; padding-top: 0">
                        <div class="row">
                            <div class="col-xs-12 no-padding" id="LPGComboDiscount">
                                <p id="LPGComboDiscountMessage" class="btn-checkout no-margin" style="font-weight: normal; font-size: 12px;"></p>
                            </div>
                            <!-- /.col -->
                        </div>
                        <!-- /.row -->
                    </div>
                    <div class="modal-body">

                        <!-- Begin shopping cart content -->
                        <div class="cart-content" id="emptyModal">
                            <div id="emp"></div>
                            <ul class="cart-product-list" id="cartModalData">

                                @*<li><div class="cart-product"><a href="#" class="cart-pr-thumb bg-image"><img src="http://dotnet.nerdcastlebd.com/EFreshStoreApp/Content/img/product//201907291446012114.jpg" alt="No Image" width="65"></a><div class="cart-pr-info"><a href="#" class="cart-pr-title">Super Pure Full Cream Milk Powder</a><div class="cart-pr-price">3000</div><div class="cart-pr-quantity">Quantity: <span>10</span></div></div><a href="#0" class="cart-pr-remove" title="Remove from cart">×</a></div></li>*@
                                @*<li>
                                        Begin shopping cart product
                                        <div class="cart-product">
                                            <a href="#" class="cart-pr-thumb bg-image"><img src="images/products/img01.jpg" alt="Lorem ipsum dolor" width="65"></a>
                                            <div class="cart-pr-info">
                                                <a href="#" class="cart-pr-title">Lorem ipsum dolor sit amet Consectetur</a>
                                                <div class="cart-pr-price">$920.00</div>
                                                <div class="cart-pr-quantity">Quantity: <span>1</span></div>
                                            </div>
                                            <a href="#0" class="cart-pr-remove" title="Remove from cart">×</a>
                                        </div>
                                        End shopping cart product
                                    </li>*@
                            </ul>
                        </div>
                        <!-- End shopping cart content -->
                    </div>
                    <div class="modal-footer padding-vertical-0">
                        <div class="cart-total"> <strong>Subtotal:</strong> <span id="subTotal"> <!-- Subtotal --> </span> </div>
                        <div class="row">
                            <div class="col-xs-6 no-padding"> <a href="@Url.Action("Cart","Order")" class="view-cart no-margin">View Cart</a> </div>
                            <!-- /.col -->

                            <div class="col-xs-6 no-padding"> <a href="@Url.Action("Checkout","Order")" class="btn-checkout no-margin">Checkout</a> </div>
                            <!-- /.col -->
                        </div>
                        <!-- /.row -->
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>
    </div>
    <div id="modal-quickview" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-body">
                <a data-dismiss="modal" style="font-size: 18px; color: red; padding: 10px 10px 0 0; float: right; cursor: pointer">X</a>
                <div class="product-view-area" id="ProductQuickView">

                </div>
            </div>
            <div class="modal-footer"></div>
        </div>
    </div>


    <!-- mobile menu -->
    <div id="jtv-mobile-menu" class="jtv-mobile-menu">
        <ul>
            <li class="">
                <a href="@Url.Action("Index","Home")">Home</a>
            </li>
            <li>
                <a href="">Categories</a>
                <ul>
                    @if (categories != null)
                    {
                        foreach (var category in categories)
                        {
                            <li><a href="~/search/category/@category.Id">@category.Name @*<span class="menu-item-tag menu-item-tag-hot">hot</span>*@</a></li>
                        }
                    }
                </ul>
            </li>
            <li>
                <a href="">Brands</a>
                <ul class="">
                    @if (brands != null)
                    {
                        foreach (var brand in brands)
                        {
                            <li><a href="~/search/brand/@brand.Id">@brand.Name @*<span class="menu-item-tag menu-item-tag-hot">hot</span>*@</a></li>
                        }
                    }
                </ul>
            </li>
            <li><a href="@Url.Action("ContactUs","Home")">Contact</a> </li>
        </ul>
    </div>

    <!-- Modal: Delivery Man Details-->
    <div class="modal fade" id="modalCart" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <!--Header-->
                <div class="modal-header">
                    <h3 class="modal-title" id="OrderModalHeader" style="color:white">Delivery Man Details</h3>
                </div>
                <!--Body-->
                <div class="modal-body table responsive" id="OrderDetailsModal">
                    <table class="table table-hover table-condensed table-bordered" style="margin: 0">
                        <tbody id="DeliveryManImage" style="float: left;width: 30%"></tbody>
                        <tbody id="DeliveryManDetails" style="float: right; width: 70%; border-top: 0px solid;vertical-align: middle"></tbody>
                    </table>

                </div>
                <!--Footer-->
                <div class="modal-footer">
                    <button data-dismiss="modal" class="btn btn-primary" style="float: right">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal: Delivery Man Details End-->
    <!-- jquery js -->
    <script type="text/javascript" src="~/Content/js/jquery.min.js"></script>
    <!-- bootstrap js -->
    <script type="text/javascript" src="~/Content/js/bootstrap.min.js"></script>
    <!-- Mean Menu js -->
    <script type="text/javascript" src="~/Content/js/jquery.meanMenu.min.js"></script>
    <!-- owl.carousel.min js -->
    <script type="text/javascript" src="~/Content/js/owl.carousel.min.js"></script>
    <!-- bxslider js -->
    <script type="text/javascript" src="~/Content/js/jquery.bxslider.js"></script>
    <!--jquery-ui.min js -->
    <script type="text/javascript" src="~/Content/js/jquery-ui.js"></script>
    <!-- wow JS -->
    <script type="text/javascript" src="~/Content/js/wow.min.js"></script>
    <!-- flexslider js -->
    <script type="text/javascript" src="~/Content/js/jquery.flexslider.js"></script>
    <!-- mobile Menu JS -->
    <script type="text/javascript" src="~/Content/js/jtv-mobile-Menu.js"></script>
    <!-- main js -->
    <script type="text/javascript" src="~/Content/js/main.js"></script>
    <!-- countdown js -->
    <script type="text/javascript" src="~/Content/js/countdown.js"></script>
    <!-- nivo slider js -->
    <script type="text/javascript" src="~/Content/js/jquery.nivo.slider.js"></script>
    <!-- revolution slider js -->
    <script type="text/javascript" src="~/Content/js/revolution-slider.js"></script>
    <script src="~/Scripts/toastr.js"></script>
    <script src="~/Scripts/star-rating.min.js"></script>
    <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script src="~/Scripts/jquery.validate.min.js">
    </script>
    <script src="~/Scripts/typeahead.bundle.js"></script>
    <script type="text/javascript">

        /* ======================================
                        Preloader
        ====================================== */
        $(window).on("load", function () {
            $('#sk-three-bounce').fadeOut();
            $('#preloader').delay(350).fadeOut('slow');
        });
        $('#loginFloatBox').show();
        var isPageLoad = false;
        jQuery(document).ready(function () {

            $(".ui-autocomplete-input").css({ fontSize: '17px', width: '300px' });
            $("#emp").empty();
            $('#loadingGif').hide();
            $("#emp").append('<div align="center" style="margin-top: 40%;"><img src="@BaseUrl.subDirectory/Content/images/products/EmptyCart.jpg" /></br></br><h3>Your cart is empty!</h3></div>');
            jQuery("#rev_slider_6").show().revolution({
                dottedOverlay: 'none',
                delay: 5000,
                startwidth: 870,
                startheight: 300,
                hideThumbs: 200,
                thumbWidth: 200,
                thumbHeight: 50,
                thumbAmount: 2,

                navigationType: 'thumb',
                navigationArrows: 'solo',
                navigationStyle: 'round',

                touchenabled: 'on',
                onHoverStop: 'on',

                swipe_velocity: 0.7,
                swipe_min_touches: 1,
                swipe_max_touches: 1,
                drag_block_vertical: false,

                spinner: 'spinner0',
                keyboardNavigation: 'off',

                navigationHAlign: 'center',
                navigationVAlign: 'bottom',
                navigationHOffset: 0,
                navigationVOffset: 20,

                soloArrowLeftHalign: 'left',
                soloArrowLeftValign: 'center',
                soloArrowLeftHOffset: 20,
                soloArrowLeftVOffset: 0,

                soloArrowRightHalign: 'right',
                soloArrowRightValign: 'center',
                soloArrowRightHOffset: 20,
                soloArrowRightVOffset: 0,

                shadow: 0,
                fullWidth: 'off',
                fullScreen: 'off',

                stopLoop: 'off',
                stopAfterLoops: -1,
                stopAtSlide: -1,

                shuffle: 'off',

                autoHeight: 'off',
                forceFullWidth: 'off',
                fullScreenAlignForce: 'off',
                minFullScreenHeight: 0,
                hideNavDelayOnMobile: 1500,

                hideThumbsOnMobile: 'off',
                hideBulletsOnMobile: 'off',
                hideArrowsOnMobile: 'off',
                hideThumbsUnderResolution: 0,

                hideSliderAtLimit: 0,
                hideCaptionAtLimit: 0,
                hideAllCaptionAtLilmit: 0,
                startWithSlide: 0,
                fullScreenOffsetContainer: ''
            });
            //$('#cartModalData').append('<li><div class="cart-product" align="center" background="white"><h3>Your cart is empty !</h3></div></li>');
            $("#searchString").autocomplete({
                source: function (request, response) {

                    $.ajax({
                        url: '@Url.Action("autoFillSearchBox","Home")',
                        type: "POST",
                        dataType: "json",

                        data: { searchString: request.term },
                        success: function (data) {
                            response($.map(data, function (key, item) {
                                //alert(key);
                                return {
                                    label: key
                                };
                            }));

                        }
                    });
                },

                messages: {
                    noResults: "",
                    results: ""
                }
            });

            isPageLoad = true;
            addtoCart();
        });

        $('.button').click(function () {
            var buttonId = $(this).attr('id');
            $('#modal-container').removeAttr('class').addClass(buttonId);
            $('body').addClass('modal-active');
        });

        $('#modal-container').click(function () {

            $(this).addClass('out');
            $('body').removeClass('modal-active');
        });
        function goToLogin() {
            window.location.href = '@Url.Action("Login","Home")';
        }


        @*//clear All
    function GetCartData() {

        $.ajax({
            type: "POST",
            url: '@Url.Action("IsUserLoggedIn", "Product")',
            contentType: "application/json;charset=UTF-8",
            success: function() {
                $("#cartModalData").empty();
                $('#CartCountItem').empty();
                $('#subTotal').empty();
                $('#totalCartItems').empty();
                $("#emp").empty();
                $("#emp").append('<div align="center" style="margin-top: 40%;"><img src="../Content/images/products/EmptyCart.jpg" /></br></br><h3>Your cart is empty!</h3></div>');
            }
        });
    }*@


        /*************************************
         *           Start Rating
         ************************************/
        // Set this to the width of one star.
        var starWidth = 14;

        $.fn.stars = function () {
            return $(this).each(function () {
                $(this).html($('<span />').width(Math.max(0, (Math.min(5, parseFloat($(this).html())))) * starWidth));
            });
        }
        $(document).ready(function () {
            $('span.stars').stars();
        });

        /************ Star rating for details page ***********/
        // Set this to the width of one star.
        var detailsStarWidth = 16;

        $.fn.detailsStars = function () {
            return $(this).each(function () {
                $(this).html($('<span />').width(Math.max(0, (Math.min(5, parseFloat($(this).html())))) * detailsStarWidth));
            });
        }
        $(document).ready(function () {
            $('span.details-stars').detailsStars();
        });

        /************ Star rating for home and search pages ***********/
        //Add to cart script
        var isAdded = false;

        function addtoCart(row) {
            var pUnitId = $('#pUnitId_' + row).val();
            var pTypeId = $('#pTypeId_' + row).val();
            var pUnit = $('#pUnit_' + row).val();
            var pName = $('#pName_' + row).val();
            var unitPrice = $('#unitPriceWithoutDiscount_' + row).val();
            var discountPrice = $('#unitPrice_' + row).val();
            var pimage = $('#pImage_' + row).val();
            var distributorPrice = $('#distributorPrice_' + row).val();
            var brandName = $('#brandName_' + row).val();
            var categoryName = $('#categoryName_' + row).val();
            var quantity = "";
            addItemToCart(pUnitId, pTypeId, pName, quantity, unitPrice, pimage, discountPrice, distributorPrice, brandName, categoryName, pUnit);
        }
        function addItemToCart(pUnitId, pTypeId, pName, quantity, unitPrice, pimage, discountPrice, distributorPrice, brandName, categoryName, pUnit) {
            var getProduct = {};
            var productUnit = {};
            getProduct.Name = pName;
            getProduct.unitPrice = unitPrice;
            //getProduct.discountPrice = discountPrice;
            productUnit.Product = getProduct;
            var product = {};
            product.ProductUnit = productUnit;
            product.ProductUnitId = pUnitId;
            product.ProductTypeId = pTypeId;
            product.Unit = pUnit;
            product.DistributorPrice = parseFloat(distributorPrice);
            product.BrandName = brandName;
            product.CategoryName = categoryName;
            if (quantity !== "") {
                product.Quantity = parseInt(quantity);
                product.Price = parseFloat(unitPrice) * parseInt(quantity);
            } else {
                product.Quantity = parseInt(1);
                product.Price = parseFloat(unitPrice) * parseInt(1);
            }

            $('#subTotalInCart').empty();
            $("#cartModalData").empty();
            $('#subTotal').empty();
            $('#totalCartItems').empty();
            $('#CartCountItem').empty();
            var postData = { details: product, image: pimage, discountPrice: discountPrice }

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetCartData","Product")',
                data: JSON.stringify(postData),
                contentType: "application/json;charset=UTF-8",
                //dataType: "json",
                //crossDomain: true, ৳
                success: function (data) {
                    if (data.cartViews.length === 0) {
                        $("#cartModalData").empty();
                        $('#CartCountItem').empty();
                        $('#subTotal').empty();
                        $('#totalCartItems').empty();
                        $("#emp").empty();
                        $("#emp").append('<div align="center" style="margin-top: 40%;"><img src="@BaseUrl.subDirectory/Content/images/products/EmptyCart.jpg" /></br></br><h3>Your cart is empty!</h3></div>');
                    }
                    else {
                        $('#subTotalInCart').empty();
                        $("#cartModalData").empty();
                        $('#CartCountItem').empty();
                        $('#subTotal').empty();
                        $('#totalCartItems').empty();
                        $("#emp").empty();
                        $("#LPGComboDiscountMessage").empty();

                        var count = data.cartViews.length;
                        var lpgDiscount = data.lpgComboDiscount;
                        console.log(lpgDiscount);
                        $("#LPGComboDiscountMessage").append("You have saved ৳" + lpgDiscount);
                        $('#CartCountItem').append('<span class="cart-num">' + count + '</span>');
                        var subtotal = 0.0;
                        $('#totalCartItems').append(count + ' items in your cart');
                        $.each(data.cartViews, function (key, value) {
                            subtotal += value.Price;
                            var price = value.Price;
                            var image = "Content/img/product/NoProductImage.png";
                            if (value.ProductImage === null) {
                                image = "Content/img/product/NoProductImage.png";
                            } else {
                                image = value.ProductImage;
                            }
                            $('#cartModalData').append('<li><div class="cart-product"><a href="#" class="cart-pr-thumb bg-image"><img src="' + '@BaseUrl.baseUrl/' + image + '" alt="No Image" width="65"></a><div class="cart-pr-info"><a href="#" class="cart-pr-title">' + value.ProductName + '</a><div class="cart-pr-price">৳ ' + price.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</div><div class="cart-pr-quantity">Quantity: <span>' + value.Quantity + '</span></div></div><a onclick="DeleteFromCart(' + value.ProductUnitId + ')" class="cart-pr-remove" style="cursor: pointer" title="Remove from cart">×</a></div></li>');
                        });
                        var total = subtotal.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                        if (data.hasDiscount) {
                            total = parseFloat(data.totalUpdatedPrice).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                        }

                        $('#subTotal').append('৳ ' + total);
                        $('#subTotalInCart').empty();
                        $('#subTotalInCart').append('৳ ' + total);
                        if (isPageLoad === false) {
                            $("#FloatBox").effect("bounce", { times: 3 }, 1000);
                        }



                    }
                    isPageLoad = false;
                    isAdded = true;
                }
            });
        }
        //search without load function
        function searchBrand(brandId) {
            //$("#preloader").css('opacity', '0.3');
            $("#preloader").css('display', 'block');
            var products = { brandId: brandId };

            $.ajax({
                type: "GET",
                url: "@Url.Action("SearchBrandWise", "Home")",
                data: products,
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                crossDomain: true,
                success: function (data) {
                    $("#all").empty();


                    if (data.length === 0) {
                        $("#all").empty();
                        $("#all").append(' <div align="center"><img src="@BaseUrl.subDirectory/Content/images/products/noitemfound.png" style="height: 30%; width: 30%;"/><p style="font-size: 24px; color: #919090; font-weight: bold; padding: 10px">Sorry, no product found!</p></div>');
                        window.history.pushState(products, null, "/home/brand/" + brandId);
                    }
                    else {
                        $.each(data, function (index, value) {
                            var price = value.PorductDiscountPrice;
                            var id = value.Id;
                            var images = {};
                            var image = "@BaseUrl.baseUrl/Content/img/product/NoProductImage.png";
                            if (value.ProductImage !== null) {
                                image = '@BaseUrl.baseUrl/' + value.ProductImages[0].ImageLocation;
                            }

                            var starWidth = 14;
                            var averageRating = value.AverageRating;
                            var existsInWishList = value.ExistsInWishList;
                            var productTypeId = value.Product.Category.ProductTypeId;
                            var inWishlist = "";
                            if (existsInWishList === true) {
                                inWishlist = "in-wishlist";
                            }
                            if (price != null) {
                                //  $("#all").append('<div class="product-item col-md-3 col-sm-6"><div class="item-inner"><div class="product-thumbnail"><div class="icon-new-label new-left">new</div><div class="box-hover"><div class="btn-quickview"> <a href="#" data-toggle="modal" data-target="#modal-quickview"><i class="fa fa-search-plus" aria-hidden="true"></i> Quick View</a> </div><div class="add-to-links" data-role="add-to-links"> <a href="wishlist.html" class="action add-to-wishlist" title="Add to Wishlist"></a> <a href="compare.html" class="action add-to-compare" title="Add to Compare"></a> </div></div><div class="slider-items-products"><div id="pro1-slider" class="product-flexslider hidden-buttons"><div class="slider-items slider-width-col6"> <a href="single_product.html" class="product-item-photo"> <img class="product-image-photo" src="images/products/img01.jpg" alt=""></a> <a href="single_product.html" class="product-item-photo"> <img class="product-image-photo" src="images/products/img01.jpg" alt=""></a> <a href="single_product.html" class="product-item-photo"> <img class="product-image-photo" src="'+'@BaseUrl.baseUrl/' + value.ProductImages[0].ImageLocation + '" alt=""></a> </div></div></div></div><div class="pro-box-info"><div class="item-info"><div class="info-inner"><div class="item-title"><h4> <a title="'+value.Product.Name+ '" href="single_product.html"> '+value.Product.Name+ '</a></h4></div><div class="item-content"><div class="rating">  <a style="font-size: 14px">'+value.StockKeepingUnit+'</a> </div><div class="item-price"><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price">'+price+' </span> </p><p class="old-price"> <span class="price-label">Regular Price:</span> <span class="price"> '+value.MaximumRetailPrice+' </span> </p></div></div></div></div></div><div class="box-hover"><div class="product-item-actions"><div class="pro-actions"><button class="action add-to-cart" type="button" title="Add to Cart"> <span>Add to Cart</span> </button></div></div></div></div></div></div>');
                                $("#all").append('<input type="hidden" id="unitPrice_' + value.Id + '" value="' + value.PorductDiscountPrice + '"/><input type="hidden" id="pTypeId_' + value.Id + '" value="' + productTypeId + '"/><input type="hidden" id="pUnitId_' + value.Id + '" value="' + value.Id + '"/><input type="hidden" id="pUnit_' + value.Id + '" value="' + value.StockKeepingUnit + '" /><input type="hidden" id="pName_' + value.Id + '" value="' + value.Product.Name + '" /><input type="hidden" id="brandName_' + value.Id + '" value="' + value.Product.Brand.Name + '" /><input type="hidden" id="categoryName_' + value.Id + '" value="' + value.Product.Category.Name + '" /><input type="hidden" id="pImage_' + value.Id + '" value="' + image + '" /><input type="hidden" id="distributorPrice_' + value.Id + '" value="' + value.DistributorPricePerCarton + '"/><input type="hidden" id="unitPriceWithoutDiscount_' + value.Id + '" value="' + value.MaximumRetailPrice + '" /><div class="product-item col-md-3 col-sm-6" id="divProduct"> <div class="item-inner" id="productContent"><div class="product-thumbnail"><div class="box-hover"><div class="add-to-links" data-role="add-to-links"> <div class="btn-quickview"><a href="#" data-toggle="modal" data-target="#modal-quickview" onclick="QuickView(' + value.Id + ')"><i class="fa fa-search-plus" aria-hidden="true"></i> Quick View</a></div><div class="wishlist-wrapper"><a onclick="addOrRemoveFromWishList(' + value.Id + ')" role="button" title="Add to Wishlist"><div id="icon-wishlist_' + value.Id + '" class="icon-wishlist ' + inWishlist + '"></div></a></div></div></div><a href="@BaseUrl.subDirectory/Product/Details/' + value.Id + '" class="product-item-photo"><img src="' + image + '" alt="product"></a></div><div class="pro-box-info"><div class="item-info"><div class="info-inner"><div class="item-title"><a href="@BaseUrl.subDirectory/Product/Details/' + value.Id + '" title="' + value.Product.Name + '">' + value.Product.Name + '</a></div><div class="item-content"><div class="rating"><span class="stars"><span style="width: ' + (Math.max(0, (Math.min(5, parseFloat(averageRating)))) * starWidth) + 'px;"></span></span><a style="font-size: 14px">' + value.StockKeepingUnit + '</a></div><div class="item-price"><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price"> &#2547; ' + value.PorductDiscountPrice.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' </span> </p><p class="old-price"> <span class="price-label">Regular Price:</span> <span class="price"> &#2547; ' + value.MaximumRetailPrice.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' </span> </p></div> </div></div></div></div><div class="box-hover"><div class="product-item-actions"><div class="pro-actions"><button onclick="addtoCart(' + value.Id + ')" class="action add-to-cart" type="button" title="Add to Cart"> <span>Add to Cart</span> </button></div></div></div></div></div></div>');
                            } else {
                                $("#all").append('<input type="hidden" id="unitPrice_' + value.Id + '" value="' + value.MaximumRetailPrice + '"/><input type="hidden" id="pTypeId_' + value.Id + '" value="' + productTypeId + '"/><input type="hidden" id="pUnitId_' + value.Id + '" value="' + value.Id + '"/><input type="hidden" id="pUnit_' + value.Id + '" value="' + value.StockKeepingUnit + '" /><input type="hidden" id="pName_' + value.Id + '" value="' + value.Product.Name + '" /><input type="hidden" id="brandName_' + value.Id + '" value="' + value.Product.Brand.Name + '" /><input type="hidden" id="categoryName_' + value.Id + '" value="' + value.Product.Category.Name + '" /><input type="hidden" id="pImage_' + value.Id + '" value="' + image + '" /><input type="hidden" id="distributorPrice_' + value.Id + '" value="' + value.DistributorPricePerCarton + '"/><input type="hidden" id="unitPriceWithoutDiscount_' + value.Id + '" value="' + value.MaximumRetailPrice + '" /><div class="product-item col-md-3 col-sm-6" id="divProduct"> <div class="item-inner" id="productContent"><div class="product-thumbnail"><div class="box-hover"><div class="add-to-links" data-role="add-to-links"> <div class="btn-quickview"> <a href="#" data-toggle="modal" data-target="#modal-quickview" onclick="QuickView(' + value.Id + ')"><i class="fa fa-search-plus" aria-hidden="true"></i> Quick View</a> </div><div class="wishlist-wrapper"><a onclick="addOrRemoveFromWishList(' + value.Id + ')" role="button" title="Add to Wishlist"><div id="icon-wishlist_' + value.Id + '" class="icon-wishlist ' + inWishlist + '"></div></a></div></div></div><a href="@BaseUrl.subDirectory/Product/Details/' + value.Id + '" class="product-item-photo"><img src="' + image + '" alt="product"></a></div><div class="pro-box-info"><div class="item-info"><div class="info-inner"><div class="item-title"><a href="@BaseUrl.subDirectory/Product/Details/' + value.Id + '" title="' + value.Product.Name + '">' + value.Product.Name + '</a></div><div class="item-content"><div class="rating"><span class="stars"><span style="width: ' + (Math.max(0, (Math.min(5, parseFloat(averageRating)))) * starWidth) + 'px;"></span></span><a style="font-size: 14px">' + value.StockKeepingUnit + '</a></div><div class="item-price"><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price"> &#2547; ' + value.MaximumRetailPrice.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' </span> </p></div> </div></div></div></div><div class="box-hover"><div class="product-item-actions"><div class="pro-actions"><button onclick="addtoCart(' + value.Id + ')" class="action add-to-cart" type="button" title="Add to Cart"> <span>Add to Cart</span> </button></div></div></div></div></div></div>');

                            }
                            if (brandId > 0) {
                                window.history.pushState(products, null, "/home/brand/" + brandId);

                            } else {
                                window.history.pushState(products, null, "/home");
                            }
                        });

                    }



                    $("#preloader").css('display', 'none');
                },
                error: function () {
                    toastr.error("Something went wrong");
                }
            });
        }
        //Load product without loading page in Search page
        function search(brandId, categoryId, searchString) {
            if (isPageLoad === false) {
                var Search = "";
                var searchStringName = "";
                if (brandId !== "") {
                    Search = brandId;
                    searchStringName = "brandId";
                }
                else if (categoryId !== "") {
                    Search = categoryId;
                    searchStringName = "categoryId";

                }
                else {
                    Search = searchString;
                    searchStringName = "searchString";
                }
                var products = { brandId: brandId, categoryId: categoryId, q: searchString };
                $("#allProduct").empty();
                $("#allProduct").append('<div id="loadingGif1" align="center"> <img src="@BaseUrl.subDirectory/Content/images/products/loading.gif"/></div>');
                $.ajax({
                    type: "GET",
                    url: "@Url.Action("SearchProduct", "Home")",
                    data: {
                        "brandId": brandId,
                        "categoryId": categoryId,
                        "searchString": searchString
                    },
                    contentType: "application/json;charset=UTF-8",
                    dataType: "json",
                    crossDomain: true,
                    success: function (data) {
                        if (data.length == 0) {
                            $("#allProduct").empty();
                            $("#allProduct").append(' <div align="center"><img src="@BaseUrl.subDirectory/Content/images/products/noitemfound.png" style="height: 30%; width: 30%;"/><p style="font-size: 24px; color: #919090; font-weight: bold; padding: 10px">Sorry, no product found!</p></div>');
                            window.history.pushState(products, null, "Search?" + searchStringName + "=" + Search);
                        } else {
                            $.each(data, function (index, value) {

                                $("#loadingGif1").hide();
                                var price = value.PorductDiscountPrice;
                                var id = value.Id;
                                var image = "@BaseUrl.baseUrl/Content/img/product/NoProductImage.png";
                                if (value.ProductImages.length !== 0) {
                                    image = '@BaseUrl.baseUrl/' + value.ProductImages[0].ImageLocation;
                                }
                                var starWidth = 14;
                                var averageRating = value.AverageRating;
                                var existsInWishList = value.ExistsInWishList;
                                var productTypeId = value.Product.Category.ProductTypeId;
                                var inWishlist = "";
                                if (existsInWishList === true) {
                                    inWishlist = "in-wishlist";
                                }
                                if (price != null) {
                                    // $("#all").append('<input type="hidden" id="pUnitId_'+value.Id+'" value="'+value.Id+'"/><input type="hidden" id="pUnit_'+value.Id+'" value="'+value.StockKeepingUnit+'" /><input type="hidden" id="pName_'+value.Id+'" value="'+value.Product.Name+'" /><input type="hidden" id="brandName_'+value.Id+'" value="'+value.Product.Brand.Name+'" /><input type="hidden" id="categoryName_'+value.Id+'" value="'+value.Product.Category.Name+'" /><input type="hidden" id="pImage_'+value.Id+'" value="'+ value.ProductImages[0].ImageLocation +'" /><input type="hidden" id="distributorPrice_'+value.Id+'" value="'+value.DistributorPricePerCarton+'"/><input type="hidden" id="unitPriceWithoutDiscount_'+value.Id+'" value="'+value.MaximumRetailPrice+'" /> <div class="product-item col-md-3 col-sm-6" id="divProduct"> <div class="item-inner" id="productContent"><div class="product-thumbnail"><a class="product-item-photo"><img src="'+'@BaseUrl.baseUrl/' + value.ProductImages[0].ImageLocation + '" alt="product"></a></div><div class="pro-box-info"><div class="item-info"><div class="info-inner"><div class="item-title"><a title="'+value.Product.Name+'">'+value.Product.Name+'</a></div><div class="item-content"><div class="rating"><a style="font-size: 14px">'+value.StockKeepingUnit+'</a></div><div class="item-price"><input type="hidden" id="unitPrice_'+value.Id+'" value="'+value.PorductDiscountPrice+'"/><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price"> &#2547; '+value.PorductDiscountPrice+' </span> </p><p class="old-price"> <span class="price-label">Regular Price:</span> <span class="price"> &#2547; '+value.MaximumRetailPrice+' </span> </p></div> </div></div></div></div><div class="box-hover"><div class="product-item-actions"><div class="pro-actions"><button onclick="addtoCart('+value.Id+')" class="action add-to-cart" type="button" title="Add to Cart"> <span>Add to Cart</span> </button></div></div></div></div></div></div>');

                                    $("#allProduct").append('<ul class="products-grid" id="allProduct"><input type="hidden" id="pTypeId_' + value.Id + '" value="' + productTypeId + '"/><input type="hidden" id="pUnitId_' + value.Id + '" value="' + value.Id + '"/><input type="hidden" id="pName_' + value.Id + '" value="' + value.Product.Name + '"/><input type="hidden" id="pImage_' + value.Id + '" value="' + image + '"/><input type="hidden" id="pUnit_' + value.Id + '" value="' + value.StockKeepingUnit + '"/><input type="hidden" id="brandName_' + value.Id + '" value="' + value.Product.Brand.Name + '"/><input type="hidden" id="categoryName_' + value.Id + '" value="' + value.Product.Category.Name + '"/><input type="hidden" id="unitPriceWithoutDiscount_' + value.Id + '" value="' + value.MaximumRetailPrice + '"/><input type="hidden" id="distributorPrice_' + value.Id + '" value="' + value.DistributorPricePerCarton + '"/><li class="item col-lg-4 col-md-4 col-sm-6 col-xs-12"><div class="product-item"><div class="item-inner"><div class="product-thumbnail"><div class="box-hover"><div class="add-to-links" data-role="add-to-links"> <div class="btn-quickview"> <a href="#" data-toggle="modal" data-target="#modal-quickview" onclick="QuickView(' + value.Id + ')"><i class="fa fa-search-plus" aria-hidden="true"></i> Quick View</a> </div><div class="wishlist-wrapper"><a onclick="addOrRemoveFromWishList(' + value.Id + ')" role="button" title="Add to Wishlist"><div id="icon-wishlist_' + value.Id + '" class="icon-wishlist ' + inWishlist + '"></div></a></div></div></div><a href="@BaseUrl.subDirectory/Product/Details/' + value.Id + '" class="product-item-photo"><img src="' + image + '" alt="product"></a></div><div class="pro-box-info"><div class="item-info"><div class="info-inner"><div class="item-title"><h4><a href="@BaseUrl.subDirectory/Product/Details/' + value.Id + '" title="' + value.Product.Name + '" href="">' + value.Product.Name + '</a></h4></div><div class="item-content"><div class="rating"><span class="stars"><span style="width: ' + (Math.max(0, (Math.min(5, parseFloat(averageRating)))) * starWidth) + 'px;"></span></span><a style="font-size: 14px">' + value.StockKeepingUnit + '</a></div><div class="item-price"><input type="hidden" id="unitPrice_' + value.Id + '" value="' + value.PorductDiscountPrice + '"/><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price"> &#2547; ' + value.PorductDiscountPrice.toFixed(2) + ' </span> </p><p class="old-price"> <span class="price-label">Regular Price:</span> <span class="price"> &#2547; ' + value.MaximumRetailPrice.toFixed(2) + '</span> </p></div></div></div></div></div><div class="box-hover"><div class="product-item-actions"><div class="pro-actions"><button onclick="addtoCart(' + value.Id + ')" class="action add-to-cart" type="button" title="Add to Cart"> <span>Add to Cart</span> </button></div></div></div></div></div></div></li></ul>');
                                } else {
                                    //  $("#all").append('<input type="hidden" id="pUnitId_'+value.Id+'" value="'+value.Id+'"/><input type="hidden" id="pUnit_'+value.Id+'" value="'+value.StockKeepingUnit+'" /><input type="hidden" id="pName_'+value.Id+'" value="'+value.Product.Name+'" /><input type="hidden" id="brandName_'+value.Id+'" value="'+value.Product.Brand.Name+'" /><input type="hidden" id="categoryName_'+value.Id+'" value="'+value.Product.Category.Name+'" /><input type="hidden" id="pImage_'+value.Id+'" value="'+ value.ProductImages[0].ImageLocation +'" /><input type="hidden" id="distributorPrice_'+value.Id+'" value="'+value.DistributorPricePerCarton+'"/><input type="hidden" id="unitPriceWithoutDiscount_'+value.Id+'" value="'+value.MaximumRetailPrice+'" /> <input type="hidden" id="unitPrice_'+value.Id+'" value="'+value.MaximumRetailPrice+'"/><div class="product-item col-md-3 col-sm-6" id="divProduct"> <div class="item-inner" id="productContent"><div class="product-thumbnail"><a class="product-
                                    //-photo"><img src="'+'@BaseUrl.baseUrl/' + value.ProductImages[0].ImageLocation + '" alt="product"></a></div><div class="pro-box-info"><div class="item-info"><div class="info-inner"><div class="item-title"><a title="'+value.Product.Name+'">'+value.Product.Name+'</a></div><div class="item-content"><div class="rating"><a style="font-size: 14px">'+value.StockKeepingUnit+'</a></div><div class="item-price"><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price"> &#2547; '+value.MaximumRetailPrice+' </span> </p></div> </div></div></div></div><div class="box-hover"><div class="product-item-actions"><div class="pro-actions"><button onclick="addtoCart('+value.Id+')" class="action add-to-cart" type="button" title="Add to Cart"> <span>Add to Cart</span> </button></div></div></div></div></div></div>');
                                    $("#allProduct").append('<ul class="products-grid" id="allProduct"><input type="hidden" id="pTypeId_' + value.Id + '" value="' + productTypeId + '"/><input type="hidden" id="pUnitId_' + value.Id + '" value="' + value.Id + '"/><input type="hidden" id="pName_' + value.Id + '" value="' + value.Product.Name + '"/><input type="hidden" id="pImage_' + value.Id + '" value="' + image + '"/><input type="hidden" id="pUnit_' + value.Id + '" value="' + value.StockKeepingUnit + '"/><input type="hidden" id="brandName_' + value.Id + '" value="' + value.Product.Brand.Name + '"/><input type="hidden" id="categoryName_' + value.Id + '" value="' + value.Product.Category.Name + '"/><input type="hidden" id="unitPriceWithoutDiscount_' + value.Id + '" value="' + value.MaximumRetailPrice + '"/><input type="hidden" id="distributorPrice_' + value.Id + '" value="' + value.DistributorPricePerCarton + '"/><li class="item col-lg-4 col-md-4 col-sm-6 col-xs-12"><div class="product-item"><div class="item-inner"><div class="product-thumbnail"><div class="box-hover"><div class="add-to-links" data-role="add-to-links"> <div class="btn-quickview"> <a href="#" data-toggle="modal" data-target="#modal-quickview" onclick="QuickView(' + value.Id + ')"><i class="fa fa-search-plus" aria-hidden="true"></i> Quick View</a> </div><div class="wishlist-wrapper"><a onclick="addOrRemoveFromWishList(' + value.Id + ')" role="button" title="Add to Wishlist"><div id="icon-wishlist_' + value.Id + '" class="icon-wishlist ' + inWishlist + '"></div></a></div></div></div><a href="@BaseUrl.subDirectory/Product/Details/' + value.Id + '" class="product-item-photo"><img src="' + image + '" alt="product"></a></div><div class="pro-box-info"><div class="item-info"><div class="info-inner"><div class="item-title"><h4><a href=""@BaseUrl.subDirectory/Product/Details/' + value.Id + '"" title="' + value.Product.Name + '" href="">' + value.Product.Name + '</a></h4></div><div class="item-content"><div class="rating"><span class="stars"><span style="width: ' + (Math.max(0, (Math.min(5, parseFloat(averageRating)))) * starWidth) + 'px;"></span></span><a style="font-size: 14px">' + value.StockKeepingUnit + '</a></div><div class="item-price"><input type="hidden" id="unitPrice_' + value.Id + '" value="' + value.MaximumRetailPrice + '"/><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price"> &#2547; ' + value.MaximumRetailPrice.toFixed(2) + ' </span> </p></div></div></div></div></div><div class="box-hover"><div class="product-item-actions"><div class="pro-actions"><button onclick="addtoCart(' + value.Id + ')" class="action add-to-cart" type="button" title="Add to Cart"> <span>Add to Cart</span> </button></div></div></div></div></div></div></li></ul>');
                                }
                                window.history.pushState(products, null, "Search?" + searchStringName + "=" + Search);
                            });
                        }


                    },
                    error: function () {
                        toastr.error("Something went wrong!");

                    }
                });
            }
            isPageLoad = false;

        }
        //delete from cart ajax
        function DeleteFromCart(row) {
            var unitId = row;
            $("#cartModalData").empty();
            $('#subTotal').empty();
            $('#totalCartItems').empty();
            $('#CartCountItem').empty();

            var uId = { id: unitId };
            $.ajax({
                type: "POST",
                url: '@Url.Action("DeleteFromCart","Order")',
                data: JSON.stringify(uId),
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                crossDomain: true,
                success: function (data) {
                    if (data.status == "BadRequest") {
                        toastr.error("Something went wrong!");
                        return false;
                    }
                    if (data.cartData.length === 0) {
                        window.location.reload();
                        $('#CartCountItem').empty();
                        $('#cartModalData').empty();
                        $('#subTotal').empty();
                        $('#subTotalInCart').empty();
                        $('#totalCartItems').empty();
                        $("#emp").empty();
                        $("#emp").append('<div align="center" style="margin-top: 40%;"><img src="@BaseUrl.subDirectory/Content/images/products/EmptyCart.jpg" /></br></br><h3>Your cart is empty!</h3></div>');
                    }
                    else {
                        $("#emp").empty();
                        $("#LPGComboDiscountMessage").empty();
                        var lpgDiscount = data.lpgComboDiscount;
                        console.log(lpgDiscount);
                        $("#LPGComboDiscountMessage").append("You have saved ৳" + lpgDiscount);
                        var count = data.cartData.length;
                        $('#CartCountItem').append('<span class="cart-num">' + count + '</span>');
                        var subtotal = 0.0;
                        $('#totalCartItems').append(count + ' items in your cart');
                        $.each(data.cartData, function (key, value) {
                            var image = "Content/img/product/NoProductImage.png";
                            if (value.ProductImage.length === 0) {
                                image = "Content/img/product/NoProductImage.png";
                            } else {
                                image = value.ProductImage;
                            }
                            $('#cartModalData').append('<li><div class="cart-product"><a href="#" class="cart-pr-thumb bg-image"><img src="' + '@BaseUrl.baseUrl/' + image + '" alt="No Image" width="65"></a><div class="cart-pr-info"><a href="#" class="cart-pr-title">' + value.ProductName + '</a><div class="cart-pr-price">৳ ' + value.Price.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</div><div class="cart-pr-quantity">Quantity: <span>' + value.Quantity + '</span></div></div><a onclick="DeleteFromCart(' + value.ProductUnitId + ')" class="cart-pr-remove" style="cursor: pointer" title="Remove from cart">×</a></div></li>');
                            subtotal += value.Price;
                            //subtotal = subtotal.toFixed(2);
                        });
                        $('#subTotal').append('৳ ' + subtotal.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                        $('#subTotalInCart').empty();
                        $('#subTotalInCart').append('৳ ' + subtotal.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                    }
                }
            });
        }

        //delete from cart page
        function DeleteItemFromCart(row, userTypeId, meghnaUserTypeId) {
            row.removeAttr("onclick");
            var rowId = row.attr("data-row-id");
            var pUnitId = $('#pUnitId_' + rowId).val();
            var uId = { id: pUnitId };
            $.ajax({
                type: "POST",
                url: '@Url.Action("DeleteFromCart","Order")',
                data: JSON.stringify(uId),
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                crossDomain: true,
                success: function (data) {
                    //var count = data.length;

                    if (data.cartData.length === 0) {
                        $('#CartCountItem').empty();
                        window.location.reload();
                    } else if (data.status == "BadRequest") {
                        var grandTotal = 0;
                        grandTotal = data.subTotal;
                        $('#discountAmount').text('৳ 0.0');

                        row.closest('tr').fadeOut(500, function () {
                            row.closest('tr').remove();
                        });

                        $("#cartSubTotal").text('৳ ' + (data.subTotal * 1).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                        $("#cartGrandTotal").text('৳ ' + (grandTotal * 1).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                        addtoCart();
                    } else if (data.status == "Ok") {
                        var grandTotal = 0;
                        if (data.hasDiscount) {
                            grandTotal = data.discount.TotalUpdatedPrice;
                            $('#discountAmount').text('৳ ' + (data.discount.FinalCouponDiscount * 1).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                        } else {
                            grandTotal = data.subTotal;
                            $('#discountAmount').text('৳ 0.0');
                        }
                        $("#cartTableItems").empty();
                        //row.closest('tr').fadeOut(500, function () {
                        //    row.closest('tr').remove();

                        //});
                        $.each(data.cartData,
                                function (index, value) {
                                    var productImage = "";
                                    var hiddenFieldPriceAndUnitPrice = "";
                                    if (userTypeId === meghnaUserTypeId) {
                                        hiddenFieldPriceAndUnitPrice = "<input type='hidden' id='pUnitPrice_" + index + "' value='" + value.Price + "'/>";

                                    } else {
                                        hiddenFieldPriceAndUnitPrice = "<input type='hidden' id='pUnitPrice_" + index + "' value='" + value.UnitPrice + "'/><input type='hidden' id='dPrice_" + index + "' value='" + value.Price + "'/>";
                                    }
                                    var hiddenField_cRow = "<input type='hidden' id='cRow' value='" + index + 1 + "'/>";
                                    var hiddenField_pName = "<input type='hidden' id='pName_" + index + "' value='" + value.ProductName + "' />";
                                    var hiddenField_pImage = "<input type='hidden' id='pImage_" + index + "' value='" + value.ProductImage + "'/>";
                                    var hiddenField_pUnit = "<input type='hidden' id='pUnitId_" + index + "' value='" + value.ProductUnitId + "' />";
                                    if (value.ProductImage !== "" || value.ProductImage !== null) {
                                        productImage = "@BaseUrl.baseUrl/" + value.ProductImage;

                                    }
                                    else {
                                        productImage = "@BaseUrl.baseUrl/Content/img/product/NoProductImage.png";

                                    }
                                    var unitPrice = value.Price / value.Quantity;
                                    var userType_Id = userTypeId;
                                    var meghnaUserType_Id = meghnaUserTypeId;
                                    $("#cartTableItems").append("<tr>" + hiddenFieldPriceAndUnitPrice + hiddenField_cRow + hiddenField_pName + hiddenField_pImage + hiddenField_pUnit + "<td class='cart_product'><a href='@BaseUrl.homeUrl/Product/Details/" + value.ProductUnitId + "' target='_blank'><img src='" + productImage + "' alt='Product'></a></td>" +
                                        "<td class='cart_description'><p class='product-name'><a href='@BaseUrl.homeUrl/Product/Details/" + value.ProductUnitId + "' target='_blank' style='color: #2174a9; font-weight: bold'>" + value.ProductName + "</a></p><p class='product-name'><a>" + value.ProductUnit + "</a></p><p class='product-name'><a>Brand - " + value.Brand + "</a></p><p class='product-name'><a>Category - " + value.Category + "</a></p></td>" +
                                        "<td class='price'><span id='unitPrice_" + index + "' data-unit-price='" + unitPrice + "' style='color:#2174a9'>৳ " + unitPrice.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</span></td>" +
                                        "<td class='qty'><input class='form-control input-sm cartTextInput input-number' data-old-value='" + value.Quantity + "' type='number' value='" + value.Quantity + "' onchange='UpdateQty($(this)," + userType_Id + "," + meghnaUserType_Id + ")' data-row-id='" + index + "' id='pQty_" + index + "' step='1' min='1' max='' name='quantity'></td>" +
                                        "<td class='price'><span id='totalUnitPrice_" + index + "' style='color:#2174a9'>৳ " + value.Price.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</span></td>" +
                                        "<td class='action'><a onclick='DeleteItemFromCart($(this), " + userType_Id + "," + meghnaUserType_Id + ")' data-row-id='" + index + "' style='cursor: pointer'><i class='icon-close'></i></a></td></tr>");
                                    console.log(value);
                                });
                        $("#cartSubTotal").text('৳ ' + (data.subTotal * 1).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                        $("#cartGrandTotal").text('৳ ' + (grandTotal * 1).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                        addtoCart();
                    }
                }, error: function () {
                    toastr.error("Something went wrong!");
                }
            });
        }

        //clear All
        function ClearAllCartItems() {
            $.ajax({
                type: "POST",
                url: '@Url.Action("ClearAllCart","Order")',
                contentType: "application/json;charset=UTF-8",
                success: function () {
                    window.location.reload();
                }
            });
        }

        function getSubTotal() {
            var total = 0;
            $.ajax({
                type: "POST",
                url: '@Url.Action("GetSubTotal", "Order")',
                contentType: "application/json;charset=UTF-8",
                success: function (data) {
                    total = data;
                }

            });
            return total;
        }

        //Update Quantity from cart
        function UpdateQty(row, userTypeId, meghnaUserTypeId) {
            var rowId = row.attr("data-row-id");
            var oldValue = row.attr("data-old-value");
            var pUnitId = $('#pUnitId_' + rowId).val();
            var pTypeId = $('#pTypeId_' + rowId).val();
            var pPrice = $('#pUnitPrice_' + rowId).val();
            var pQty = $('#pQty_' + rowId).val();
            var pName = $('#pName_' + rowId).val();
            var pImage = $('#pImage_' + rowId).val();
            var brandName = $('#brandName_' + rowId).val();
            var categoryName = $('#categoryName_' + rowId).val();
            var unitPrice = $("#unitPrice_" + rowId).attr("data-unit-price");
            unitPrice = unitPrice.replace(/\,/g, '');
            if (parseInt(pQty, 10) > 0 && parseInt(pQty, 10) <= 1000) {
                row.attr('data-old-value', pQty);
                $('#pQty_' + rowId).css('border', '1px solid #eaeaea');
            }
            if (pQty === "" || parseInt(pQty, 10) == 0) {
                $("#totalUnitPrice_" + rowId).text('৳ ' + (unitPrice * oldValue).toFixed(2));
                $('#pQty_' + rowId).val(oldValue);
                pQty = oldValue;
                $('#pQty_' + rowId).css('border', '1px solid red');
                toastr.clear();
                toastr.error("Product quantity should not be less than 1");
                return false;
                //DeleteItemFromCart(row);
            }
            if (parseInt(pQty, 10) > 1000) {
                $("#totalUnitPrice_" + rowId).text('৳ ' + (unitPrice * oldValue).toFixed(2));
                $('#pQty_' + rowId).val(oldValue);
                pQty = oldValue;
                $('#pQty_' + rowId).css('border', '1px solid red');
                toastr.clear();
                toastr.error("Product quantity should not be greater than 1000");
                return false;
                //DeleteItemFromCart(row);
            }
            //$("#preloader").css('opacity', '0.3');
            $("#preloader").css('display', 'block');

            var pQuantity = { quantity: pQty, unitId: pUnitId, price: pPrice };
            $.ajax({
                type: "POST",
                url: "../Product/UpdateQuantity",
                data: JSON.stringify(pQuantity),
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                crossDomain: true,
                success: function (data) {
                    console.log(data.cartData);
                    toastr.clear();
                    $("#cartTableItems").empty();
                    $.each(data.cartData,
                            function (index, value) {
                                var productImage = "";
                                var hiddenFieldPriceAndUnitPrice = "";
                                if (userTypeId === meghnaUserTypeId) {
                                    hiddenFieldPriceAndUnitPrice = "<input type='hidden' id='pUnitPrice_" + index + "' value='" + value.Price + "'/>";

                                } else {
                                    hiddenFieldPriceAndUnitPrice = "<input type='hidden' id='pUnitPrice_" + index + "' value='" + value.UnitPrice + "'/><input type='hidden' id='dPrice_" + index + "' value='" + value.Price + "'/>";
                                }
                                var hiddenField_cRow = "<input type='hidden' id='cRow' value='" + index + 1 + "'/>";
                                var hiddenField_pName = "<input type='hidden' id='pName_" + index + "' value='" + value.ProductName + "' />";
                                var hiddenField_pImage = "<input type='hidden' id='pImage_" + index + "' value='" + value.ProductImage + "'/>";
                                var hiddenField_pUnit = "<input type='hidden' id='pUnitId_" + index + "' value='" + value.ProductUnitId + "' />";
                                if (value.ProductImage !== "" || value.ProductImage !== null) {
                                    productImage = "@BaseUrl.baseUrl/" + value.ProductImage;

                                }
                                else {
                                    productImage = "@BaseUrl.baseUrl/Content/img/product/NoProductImage.png";

                                }
                                var unitPrice = value.Price / value.Quantity;
                                var userType_Id = userTypeId;
                                var meghnaUserType_Id = meghnaUserTypeId;
                                $("#cartTableItems").append("<tr>" + hiddenFieldPriceAndUnitPrice + hiddenField_cRow + hiddenField_pName + hiddenField_pImage + hiddenField_pUnit + "<td class='cart_product'><a href='@BaseUrl.homeUrl/Product/Details/" + value.ProductUnitId + "' target='_blank'><img src='" + productImage + "' alt='Product'></a></td>" +
                                    "<td class='cart_description'><p class='product-name'><a href='@BaseUrl.homeUrl/Product/Details/" + value.ProductUnitId + "' target='_blank' style='color: #2174a9; font-weight: bold'>" + value.ProductName + "</a></p><p class='product-name'><a>" + value.ProductUnit + "</a></p><p class='product-name'><a>Brand - " + value.Brand + "</a></p><p class='product-name'><a>Category - " + value.Category + "</a></p></td>" +
                                    "<td class='price'><span id='unitPrice_" + index + "' data-unit-price='" + unitPrice + "' style='color:#2174a9'>৳ " + unitPrice.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</span></td>" +
                                    "<td class='qty'><input class='form-control input-sm cartTextInput input-number' data-old-value='" + value.Quantity + "' type='number' value='" + value.Quantity + "' onchange='UpdateQty($(this)," + userType_Id + "," + meghnaUserType_Id + ")' data-row-id='" + index + "' id='pQty_" + index + "' step='1' min='1' max='' name='quantity'></td>" +
                                    "<td class='price'><span id='totalUnitPrice_" + index + "' style='color:#2174a9'>৳ " + value.Price.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "</span></td>" +
                                    "<td class='action'><a onclick='DeleteItemFromCart($(this), " + userType_Id + "," + meghnaUserType_Id + ")' data-row-id='" + index + "' style='cursor: pointer'><i class='icon-close'></i></a></td></tr>");
                                console.log(value);
                            });
                    if (data.status == 'BadRequest') {
                        //$("#totalUnitPrice_" + rowId)
                        //    .text('৳ ' + (unitPrice * pQty).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));

                        var subTotal = $("#cartSubTotal").html().replace(/[^0-9]/g, '');

                        var grandTotal = 0;
                        grandTotal = data.subTotal;
                        $('#discountAmount').text('৳ 0.0');

                        $("#cartSubTotal")
                            .text('৳ ' + (data.subTotal * 1).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                        $("#cartGrandTotal")
                            .text('৳ ' + (grandTotal * 1).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                        $("#preloader").css('display', 'none');
                        toastr.error(data.message);
                        addtoCart();
                    } else if (data.status == 'Ok') {
                        //$("#totalUnitPrice_" + rowId)
                        //    .text('৳ ' + (unitPrice * pQty).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));

                        var subTotal = $("#cartSubTotal").html().replace(/[^0-9]/g, '');

                        var grandTotal = 0;
                        if (data.hasDiscount) {
                            grandTotal = data.discount.TotalUpdatedPrice;
                            $('#discountAmount').text('৳ ' + (data.discount.FinalCouponDiscount * 1).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                        } else {
                            grandTotal = data.subTotal;
                            $('#discountAmount').text('৳ 0.0');
                        }

                        $("#cartSubTotal")
                            .text('৳ ' + (data.subTotal * 1).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                        $("#cartGrandTotal")
                            .text('৳ ' + (grandTotal * 1).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
                        $("#preloader").css('display', 'none');
                        addtoCart();
                    } else {
                        $("#preloader").css('display', 'none');
                        toastr.error("Something went wrong!");
                        return false;
                    }
                }
            });

            //window.location.reload();
        }


        //Quick View Modal
        function QuickView(productId) {
            $('#ProductQuickView').empty();
            $('#ProductQuickView').append('<img src="/Content/images/details-preloader.gif" />');

            var prodUnitId = $('#pUnitId_' + productId).val();
            ViewProductModal(prodUnitId);
        }

        function ViewProductModal(prodUnitId) {
            var postData = { prodUnitId: prodUnitId }
            $.ajax({
                type: "POST",
                url: '@Url.Action("QuickView", "Home")',
                data: JSON.stringify(postData),
                contentType: "application/json;charset=UTF-8",
                success: function (data) {
                    $('#ProductQuickView').empty();
                    var image = "@BaseUrl.baseUrl/Content/img/product/NoProductImage.png";
                    if (data.ProductImages.length !== 0) {
                        image = '@BaseUrl.baseUrl/' + data.ProductImages[0].ImageLocation;
                    }
                    var description = data.Product.Description;
                    var name = data.Product.Name;
                    var unit = data.StockKeepingUnit;
                    var starWidth = 16;
                    var averageRating = data.AverageRating;
                    var existsInWishList = data.ExistsInWishList;
                    var inWishlist = "";
                    var wishListText = '<a id="productQuickViewWishList_' + prodUnitId + '" onclick="addProductToWishList(' +
                        prodUnitId +
                        ')" role="button"><i class="fa fa-heart"></i><span>Add to Wishlist</span></a>';
                    if (existsInWishList === true) {
                        inWishlist = "in-wishlist";
                        wishListText = '<a onclick="addProductToWishList(' +
                            prodUnitId +
                            ')" role="button" id="productQuickViewWishList_' + prodUnitId + '"><i class="fa fa-heart" style="color: red"></i><span>Added to Wishlist</span></a>';
                    }
                    if (data.PorductDiscountPrice == null) {
                        $('#ProductQuickView').append('<div class="product-big-image col-xs-12 col-sm-5 col-lg-5 col-md-5"><div class="slider-items-products"><div id="previews-list-slider" class="product-flexslider hidden-buttons"><div class="slider-items slider-width-col6"> <img class="zoom-img" src="' + image + '" alt="products"></div></div></div></div><div class="col-xs-12 col-sm-7 col-lg-7 col-md-7 product-details-area"><div class="product-name"><h2>' + name + '</h2></div><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price" style="color:#2174a9">৳ ' + data.MaximumRetailPrice.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' </span> </p></div><div class="ratings"><div class="rating"> <span class="details-stars"><span style="width: ' + (Math.max(0, (Math.min(5, parseFloat(averageRating)))) * starWidth) + 'px;"></span></div><p class="rating-links"> 1 Review(s)</p><p class="availability in-stock pull-right">Availability: <span>In Stock</span></p></div><div class="short-description"><h3>Quick Overview</h3><p style="white-space: pre-line">' + description + '</div><div class="product-cart-option"><ul><li>' + wishListText + '</li></ul></div></div>');
                    } else {
                        $('#ProductQuickView').append('<div class="product-big-image col-xs-12 col-sm-5 col-lg-5 col-md-5"><div class="slider-items-products"><div id="previews-list-slider" class="product-flexslider hidden-buttons"><div class="slider-items slider-width-col6"> <img class="zoom-img" src="' + image + '" alt="products"></div></div></div></div><div class="col-xs-12 col-sm-7 col-lg-7 col-md-7 product-details-area"><div class="product-name"><h2>' + name + '</h2></div><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price" style="color:#2174a9">৳ ' + data.PorductDiscountPrice.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' </span> </p><p class="old-price"> <span class="price-label">Regular Price:</span> <span class="price">৳ ' + data.MaximumRetailPrice.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' </span> </p></div><div class="ratings"><div class="rating"><span class="details-stars"><span style="width: ' + (Math.max(0, (Math.min(5, parseFloat(averageRating)))) * starWidth) + 'px;"></span></div><p class="rating-links"> 1 Review(s) </p><p class="availability in-stock pull-right">Availability: <span>In Stock</span></p></div><div class="short-description"><h3>Quick Overview</h3><p style="white-space: pre-line">' + description + '</div><div class="product-cart-option"><ul><li>' + wishListText + '</li></ul></div></div>');
                    }

                }

            });
        }
        /*****************************
         *        Checkout Button
        ****************************/
        //$("#CheckoutBtn").click(function (){
        //        console.log("Ok");
        //        $("#CheckoutBtn").off('click');
        //        $("#preloader").css('display', 'block');
        //        var order = {};
        //        order.CustomerName = $("#CustomerName").val();
        //        order.MobileNo = $("#MobileNo").val();
        //        order.Email = $("#Email").val();
        //        order.DeliveryAddress = $("#DeliveryAddress").val();
        //        order.ThanaId = $("#ThanaId").val();
        //        var anorder = { anOrder: order };
        //        $.ajax({
        //            url: '../Order/Checkout',
        //            type: "POST",
        //            dataType: 'JSON',
        //            contentType: "application/json; charset=utf-8",
        //            data: JSON.stringify(anorder),
        //            success: function(data) {

        //                var message = '<div class="alert alert-success alert-dismissible"><a class="close" data-dismiss="alert" aria-label="close">&times;</a><h3>' + data + '</h3></div>';
        //                if (data === "Sorry! There is no service available for this region") {
        //                    $('#CheckoutBtn').prop('disabled', false);
        //                    $("#preloader").css('display', 'none');
        //                    document.getElementById("masterLinkMessage").innerHTML = data + ". Please select another district.";
        //                } else {
        //                    $('#CheckoutBtn').prop('disabled', true);
        //                    $("#preloader").css('display', 'none');
        //                    document.getElementById("masterLinkMessage").innerHTML = "";
        //                    $("#mgs").empty();
        //                    $("#mgs").append(message);
        //                }

        //                $("#ThanaId").focus();

        //            },
        //            error: function() {
        //                alert("Something went wrong");
        //            }
        //        });
        //    });


        /**************************
         *        Wish-List
        *************************/
        // Add to wish list
        function addOrRemoveFromWishList(productId) {
            var prodUnitId = $('#pUnitId_' + productId).val();
            addProductToWishList(prodUnitId);
        }

        function addProductToWishList(prodUnitId) {
            var postData = { prodUnitId: prodUnitId }
            $.ajax({
                type: "POST",
                url: '@Url.Action("AddOrRemove", "WishList")',
                data: JSON.stringify(postData),
                contentType: "application/json;charset=UTF-8",
                //dataType: "json",
                //crossDomain: true, ৳
                success: function (data) {
                    toastr.clear();
                    if (data.status == "Ok") {
                        //toastr.warning("Product removed from wish list");
                        $('#icon-wishlist_' + prodUnitId).removeClass('in-wishlist');
                        if ($('#productDetailsWishList_' + prodUnitId).length) {
                            $('#productDetailsWishList_' + prodUnitId + ' i').css('color', '#bbb');
                            $('#productDetailsWishList_' + prodUnitId + ' span').text('Add to Wishlist');
                        }
                        if ($('#productQuickViewWishList_' + prodUnitId).length) {
                            $('#productQuickViewWishList_' + prodUnitId + ' i').css('color', '#bbb');
                            $('#productQuickViewWishList_' + prodUnitId + ' span').text('Add to Wishlist');
                        }
                    } else if (data.status == "Created") {
                        //toastr.success("Product has been added to wish list");
                        $('#icon-wishlist_' + prodUnitId).addClass('in-wishlist');
                        if ($('#productDetailsWishList_' + prodUnitId).length) {
                            $('#productDetailsWishList_' + prodUnitId + ' i').css('color', 'red');
                            $('#productDetailsWishList_' + prodUnitId + ' span').text('Added to Wishlist');
                        }
                        if ($('#productQuickViewWishList_' + prodUnitId).length) {
                            $('#productQuickViewWishList_' + prodUnitId + ' i').css('color', 'red');
                            $('#productQuickViewWishList_' + prodUnitId + ' span').text('Added to Wishlist');
                        }
                    } else if (data.status == "UnAuthorized") {
                        toastr.error("You must login to add product to wish list");
                    } else {
                        toastr.error("Something went wrong");
                    }
                }

            });
        }

        // Remove product from wish list
        function removeFromWishList(row) {
            $("#preloader").css('opacity', '0.3');
            $("#preloader").css('display', 'block');
            var wishListId = row.attr("data-wishlist-id");
            row.removeAttr("onclick");
            $("#addSingleToCart_" + wishListId).removeAttr("onclick");
            var postData = { wishListId: wishListId }
            $.ajax({
                type: "POST",
                url: '@Url.Action("Delete", "WishList")',
                data: JSON.stringify(postData),
                contentType: "application/json;charset=UTF-8",
                //dataType: "json",
                //crossDomain: true, ৳
                success: function (data) {
                    if (data.status == "Ok") {
                        row.closest('tr').fadeOut(500, function () {
                            row.closest('tr').remove();
                            $("#preloader").css('display', 'none');
                        });
                        if (row.closest('tr').siblings('tr').length == 0) {
                            $("#addAllToCartBtn").removeAttr("onclick");
                            window.location.reload();
                            $("#preloader").css('display', 'none');
                        }
                    }
                }

            });
        }

        // Add single product to cart from wish list
        function addToCartFromWishList(product, row) {
            //$("#wishListCartBtn").unbind("click");
            //row.addClass("disableClick");
            //row.removeAttr("onclick");
            addItemToCart(product.ProductUnitId, product.ProductTypeId, product.ProductName, "", product.UnitPrice, product.ProductImage, product.Price, product.DistributorPrice, product.Brand, product.Category, product.ProductUnit);
            //if (isAdded) {
            //   // removeFromWishList(row);
            //}

        }

        function deleteAllFromWishList() {
            $.ajax({
                type: "POST",
                url: '@Url.Action("DeleteAll", "WishList")',
                contentType: "application/json;charset=UTF-8",
                success: function (data) {
                    if (data.status == "Ok") {
                        window.location.reload();
                    }
                }

            });
        }
        // Add all product to cart from wish list
        function addAllProductToCartFromWishList(button) {
            //$("#preloader").css('opacity', '0.3');
            $("#preloader").css('display', 'block');
            // $(".wishlist-item").empty();
            $(window).scrollTop(0);
            // button.removeAttr("onclick");
            $.ajax({
                type: "POST",
                url: '@Url.Action("AddAllToCartFromWishList", "Product")',
                contentType: "application/json;charset=UTF-8",
                success: function (data) {
                    if (data.status === "Failed") {
                        toastr.clear();
                        toastr.error("Something went wrong");
                        window.location.reload();
                    } else if (data.status === "Ok") {
                        addtoCart();
                        window.location.reload();
                        $("#preloader").css('display', 'none');
                    } else {
                        toastr.error("Something went wrong");
                        $("#preloader").css('display', 'none');
                    }
                },
                error: function () {
                    toastr.error("Something went wrong");
                }

            });

        }

        @*function addAllProductToCartFromWishList(button) {
        button.removeAttr("onclick");
        var productList = [];
        $.ajax({
            type: "GET",
            url: '@Url.Action("GetWishList", "WishList")',
            contentType: "application/json;charset=UTF-8",
            success: function (data) {
                if (data.length == 0) {
                    window.location.reload();
                } else {
                    var productCount = 0;
                    $.each(data, function (key, product) {
                        addItemToCart(product.ProductUnitId, product.ProductName, "", product.UnitPrice, product.ProductImage, product.Price, product.DistributorPrice, product.Brand, product.Category, product.ProductUnit);
                        productCount++;
                    });

                    if (productCount === data.length) {
                        deleteAllFromWishList();
                    }
                }
            }

        });

    }*@

        /******************************************
         *  Newsletter Subscription Form Validation
        ********************************************/
        $("#newsletter-validate-detail").validate({
            errorPlacement: function (error, element) {
                error.appendTo('#newsletter-validate-message');
            },
            rules: {
                SubEmail: {
                    required: true,
                    email: true
                }
            },
            messages: {
                SubEmail: {
                    required: "Please enter your email",
                    email: "Please enter a valid email"
                }

            },
            submitHandler: function (form, e) {
                e.preventDefault();
                var email = $("#SubEmail").val();
                var input = { email: email };
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("Subscribe","Subscriber")',
                    data: JSON.stringify(input),
                    contentType: "application/json;charset=UTF-8",
                    dataType: "json",
                    crossDomain: true,
                    success: function (data) {
                        toastr.clear();
                        if (data.status == "Ok") {
                            toastr.success("Successfully subscribed to the newsletter!");
                        } else if (data.status == "Created") {
                            toastr.success("Successfully subscribed to the newsletter!");
                        } else {
                            toastr.error("Something went wrong!");
                        }
                        $("#SubEmail").val("");
                    }
                });
                return false;

            }

        });

        $(document).ready(function () {
            $('.review-link').on('click',
                function (event) {
                    // Prevent url change
                    event.preventDefault();

                    // `this` is the clicked <a> tag
                    $('[data-toggle="tab"][href="' + this.hash + '"]').trigger('click');
                    //$('.nav-tabs li:nth-child(2) a').tab('show');
                    $('html, body').animate({
                        scrollTop: $("#productTabContent").offset().top
                    }, 500);
                });
        });

        function searchProducts(input) {
            var brands = input.brandIds;
            var categories = input.categoryIds;
            $("#allProduct").empty();
            $.ajax({
                method: 'POST',
                url: "@Url.Action("SearchProduct", "Home")",
                dataType: "json",
                contentType: 'application/json',
                data: JSON.stringify(input),
                crossDomain: true,
                success: function (data) {
                    $("#preloader").css('display', 'none');

                    if (data.length == 0) {
                        $("#allProduct").empty();
                        $("#allProduct").append(' <div align="center"><img src="@BaseUrl.subDirectory/Content/images/products/noitemfound.png" style="height: 30%; width: 30%;"/><p style="font-size: 24px; color: #919090; font-weight: bold; padding: 10px">Sorry, no product found!</p></div>');
                        var filterString = "";
                        if (brands.length > 0) {
                            filterString = "brands=" + brands;
                            if (categories.length > 0) {
                                filterString = filterString + "&categories=" + categories;
                            }
                        } else {
                            filterString = "categories=" + categories;
                        }

                        window.history.pushState(input, null, "/search-by?" + filterString);
                    } else {
                        $.each(data, function (index, value) {
                            var price = value.PorductDiscountPrice;
                            var id = value.Id;
                            var image = "Content/img/product/NoProductImage.png";
                            if (value.ProductImages.length !== 0) {
                                image = value.ProductImages[0].ImageLocation;
                            }
                            var starWidth = 14;
                            var averageRating = value.AverageRating;
                            var existsInWishList = value.ExistsInWishList;
                            var productTypeId = value.Product.Category.ProductTypeId;
                            var inWishlist = "";
                            if (existsInWishList === true) {
                                inWishlist = "in-wishlist";
                            }
                            if (price != null) {
                                // $("#all").append('<input type="hidden" id="pUnitId_'+value.Id+'" value="'+value.Id+'"/><input type="hidden" id="pUnit_'+value.Id+'" value="'+value.StockKeepingUnit+'" /><input type="hidden" id="pName_'+value.Id+'" value="'+value.Product.Name+'" /><input type="hidden" id="brandName_'+value.Id+'" value="'+value.Product.Brand.Name+'" /><input type="hidden" id="categoryName_'+value.Id+'" value="'+value.Product.Category.Name+'" /><input type="hidden" id="pImage_'+value.Id+'" value="'+ value.ProductImages[0].ImageLocation +'" /><input type="hidden" id="distributorPrice_'+value.Id+'" value="'+value.DistributorPricePerCarton+'"/><input type="hidden" id="unitPriceWithoutDiscount_'+value.Id+'" value="'+value.MaximumRetailPrice+'" /> <div class="product-item col-md-3 col-sm-6" id="divProduct"> <div class="item-inner" id="productContent"><div class="product-thumbnail"><a class="product-item-photo"><img src="'+'@BaseUrl.baseUrl/' + value.ProductImages[0].ImageLocation + '" alt="product"></a></div><div class="pro-box-info"><div class="item-info"><div class="info-inner"><div class="item-title"><a title="'+value.Product.Name+'">'+value.Product.Name+'</a></div><div class="item-content"><div class="rating"><a style="font-size: 14px">'+value.StockKeepingUnit+'</a></div><div class="item-price"><input type="hidden" id="unitPrice_'+value.Id+'" value="'+value.PorductDiscountPrice+'"/><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price"> &#2547; '+value.PorductDiscountPrice+' </span> </p><p class="old-price"> <span class="price-label">Regular Price:</span> <span class="price"> &#2547; '+value.MaximumRetailPrice+' </span> </p></div> </div></div></div></div><div class="box-hover"><div class="product-item-actions"><div class="pro-actions"><button onclick="addtoCart('+value.Id+')" class="action add-to-cart" type="button" title="Add to Cart"> <span>Add to Cart</span> </button></div></div></div></div></div></div>');

                                $("#allProduct").append('<ul class="products-grid" id="allProduct"><input type="hidden" id="pTypeId_' + value.Id + '" value="' + productTypeId + '"/><input type="hidden" id="pUnitId_' + value.Id + '" value="' + value.Id + '"/><input type="hidden" id="pName_' + value.Id + '" value="' + value.Product.Name + '"/><input type="hidden" id="pImage_' + value.Id + '" value="' + image + '"/><input type="hidden" id="pUnit_' + value.Id + '" value="' + value.StockKeepingUnit + '"/><input type="hidden" id="brandName_' + value.Id + '" value="' + value.Product.Brand.Name + '"/><input type="hidden" id="categoryName_' + value.Id + '" value="' + value.Product.Category.Name + '"/><input type="hidden" id="unitPriceWithoutDiscount_' + value.Id + '" value="' + value.MaximumRetailPrice + '"/><input type="hidden" id="distributorPrice_' + value.Id + '" value="' + value.DistributorPricePerCarton + '"/><li class="item col-lg-4 col-md-4 col-sm-6 col-xs-12"><div class="product-item"><div class="item-inner"><div class="product-thumbnail"><div class="box-hover"><div class="add-to-links" data-role="add-to-links"> <div class="btn-quickview"> <a href="#" data-toggle="modal" data-target="#modal-quickview" onclick="QuickView(' + value.Id + ')"><i class="fa fa-search-plus" aria-hidden="true"></i> Quick View</a> </div><div class="wishlist-wrapper"><a onclick="addOrRemoveFromWishList(' + value.Id + ')" role="button" title="Add to Wishlist"><div id="icon-wishlist_' + value.Id + '" class="icon-wishlist ' + inWishlist + '"></div></a></div></div></div><a href="@BaseUrl.subDirectory/Product/Details/' + value.Id + '" class="product-item-photo"><img src="' + '@BaseUrl.baseUrl/' + image + '" alt="product"></a></div><div class="pro-box-info"><div class="item-info"><div class="info-inner"><div class="item-title"><h4><a href="@BaseUrl.subDirectory/Product/Details/' + value.Id + '" title="' + value.Product.Name + '" href="">' + value.Product.Name + '</a></h4></div><div class="item-content"><div class="rating"><span class="stars"><span style="width: ' + (Math.max(0, (Math.min(5, parseFloat(averageRating)))) * starWidth) + 'px;"></span></span><a style="font-size: 14px">' + value.StockKeepingUnit + '</a></div><div class="item-price"><input type="hidden" id="unitPrice_' + value.Id + '" value="' + value.PorductDiscountPrice + '"/><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price"> &#2547; ' + value.PorductDiscountPrice.toFixed(2) + ' </span> </p><p class="old-price"> <span class="price-label">Regular Price:</span> <span class="price"> &#2547; ' + value.MaximumRetailPrice.toFixed(2) + '</span> </p></div></div></div></div></div><div class="box-hover"><div class="product-item-actions"><div class="pro-actions"><button onclick="addtoCart(' + value.Id + ')" class="action add-to-cart" type="button" title="Add to Cart"> <span>Add to Cart</span> </button></div></div></div></div></div></div></li></ul>');
                            } else {
                                //  $("#all").append('<input type="hidden" id="pUnitId_'+value.Id+'" value="'+value.Id+'"/><input type="hidden" id="pUnit_'+value.Id+'" value="'+value.StockKeepingUnit+'" /><input type="hidden" id="pName_'+value.Id+'" value="'+value.Product.Name+'" /><input type="hidden" id="brandName_'+value.Id+'" value="'+value.Product.Brand.Name+'" /><input type="hidden" id="categoryName_'+value.Id+'" value="'+value.Product.Category.Name+'" /><input type="hidden" id="pImage_'+value.Id+'" value="'+ value.ProductImages[0].ImageLocation +'" /><input type="hidden" id="distributorPrice_'+value.Id+'" value="'+value.DistributorPricePerCarton+'"/><input type="hidden" id="unitPriceWithoutDiscount_'+value.Id+'" value="'+value.MaximumRetailPrice+'" /> <input type="hidden" id="unitPrice_'+value.Id+'" value="'+value.MaximumRetailPrice+'"/><div class="product-item col-md-3 col-sm-6" id="divProduct"> <div class="item-inner" id="productContent"><div class="product-thumbnail"><a class="product-item-photo"><img src="'+'@BaseUrl.baseUrl/' + value.ProductImages[0].ImageLocation + '" alt="product"></a></div><div class="pro-box-info"><div class="item-info"><div class="info-inner"><div class="item-title"><a title="'+value.Product.Name+'">'+value.Product.Name+'</a></div><div class="item-content"><div class="rating"><a style="font-size: 14px">'+value.StockKeepingUnit+'</a></div><div class="item-price"><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price"> &#2547; '+value.MaximumRetailPrice+' </span> </p></div> </div></div></div></div><div class="box-hover"><div class="product-item-actions"><div class="pro-actions"><button onclick="addtoCart('+value.Id+')" class="action add-to-cart" type="button" title="Add to Cart"> <span>Add to Cart</span> </button></div></div></div></div></div></div>');
                                $("#allProduct").append('<ul class="products-grid" id="allProduct"><input type="hidden" id="pTypeId_' + value.Id + '" value="' + productTypeId + '"/><input type="hidden" id="pUnitId_' + value.Id + '" value="' + value.Id + '"/><input type="hidden" id="pName_' + value.Id + '" value="' + value.Product.Name + '"/><input type="hidden" id="pImage_' + value.Id + '" value="' + image + '"/><input type="hidden" id="pUnit_' + value.Id + '" value="' + value.StockKeepingUnit + '"/><input type="hidden" id="brandName_' + value.Id + '" value="' + value.Product.Brand.Name + '"/><input type="hidden" id="categoryName_' + value.Id + '" value="' + value.Product.Category.Name + '"/><input type="hidden" id="unitPriceWithoutDiscount_' + value.Id + '" value="' + value.MaximumRetailPrice + '"/><input type="hidden" id="distributorPrice_' + value.Id + '" value="' + value.DistributorPricePerCarton + '"/><li class="item col-lg-4 col-md-4 col-sm-6 col-xs-12"><div class="product-item"><div class="item-inner"><div class="product-thumbnail"><div class="box-hover"><div class="add-to-links" data-role="add-to-links"> <div class="btn-quickview"> <a href="#" data-toggle="modal" data-target="#modal-quickview" onclick="QuickView(' + value.Id + ')"><i class="fa fa-search-plus" aria-hidden="true"></i> Quick View</a> </div><div class="wishlist-wrapper"><a onclick="addOrRemoveFromWishList(' + value.Id + ')" role="button" title="Add to Wishlist"><div id="icon-wishlist_' + value.Id + '" class="icon-wishlist ' + inWishlist + '"></div></a></div></div></div><a href="@BaseUrl.subDirectory/Product/Details/' + value.Id + '" class="product-item-photo"><img src="' + '@BaseUrl.baseUrl/' + image + '" alt="product"></a></div><div class="pro-box-info"><div class="item-info"><div class="info-inner"><div class="item-title"><h4><a href=""@BaseUrl.subDirectory/Product/Details/' + value.Id + '"" title="' + value.Product.Name + '" href="">' + value.Product.Name + '</a></h4></div><div class="item-content"><div class="rating"><span class="stars"><span style="width: ' + (Math.max(0, (Math.min(5, parseFloat(averageRating)))) * starWidth) + 'px;"></span></span><a style="font-size: 14px">' + value.StockKeepingUnit + '</a></div><div class="item-price"><input type="hidden" id="unitPrice_' + value.Id + '" value="' + value.MaximumRetailPrice + '"/><div class="price-box"><p class="special-price"> <span class="price-label">Special Price</span> <span class="price"> &#2547; ' + value.MaximumRetailPrice.toFixed(2) + ' </span> </p></div></div></div></div></div><div class="box-hover"><div class="product-item-actions"><div class="pro-actions"><button onclick="addtoCart(' + value.Id + ')" class="action add-to-cart" type="button" title="Add to Cart"> <span>Add to Cart</span> </button></div></div></div></div></div></div></li></ul>');
                            }
                            //window.history.pushState(products, null, "Search?" + searchStringName + "=" + Search);
                        });
                        var filterString = "";
                        if (brands.length > 0) {
                            filterString = "brands=" + brands;
                            if (categories.length > 0) {
                                filterString = filterString + "&categories=" + categories;
                            }
                        } else {
                            filterString = "categories=" + categories;
                        }

                        window.history.pushState(input, null, "/search-by?" + filterString);
                    }


                },
                error: function () {
                    toastr.error("Something went wrong!");
                    return false;
                }
            });
        }

        //$(function () {
        //    var vm = {
        //        productUnitIds: []
        //    };
        //    var products = new Bloodhound({
        //        datumTokenizer: Bloodhound.tokenizers.obj.whitespace('Product.Name'),
        //        queryTokenizer: Bloodhound.tokenizers.whitespace,

        //        remote: {
        //            url: '/Home/GetAutoCompleteResult?query=%QUERY',
        //            wildcard: '%QUERY'
        //        }
        //    });

        //    products.initialize();

        //    $('#searchString').typeahead(null, {
        //        name: 'products',
        //        displayKey: 'Product.Name',
        //        minLength: 3,
        //        source: products.ttAdapter()
        //    });
        //    $('#searchString').on('typeahead:selected', function (event, suggestion, datasetName) {
        //        console.log(suggestion);
        //    });
        //});

        $(document).ready(function () {

            var categoryId = "";
            var brandId = "";
            $(".brandId").each(function () {
                if ($(this).is(':checked')) {
                    brandId += $(this).val() + ",";
                }
            });
            $(".categoryId").each(function () {
                if ($(this).is(':checked')) {
                    categoryId += $(this).val() + ",";
                }
            });

            if (categoryId !== "" || brandId !== "") {
                var data = {};
                data.brandIds = brandId.slice(0, brandId.length - 1);
                data.categoryIds = categoryId.slice(0, categoryId.length - 1);
                searchProducts(data);
            }

            $(".brandId").click(function () {
                //$("#preloader").css('opacity', '0.3');
                $("#preloader").css('display', 'block');
                var categoryId = "";
                var brandId = "";
                $(".brandId").each(function () {
                    if ($(this).is(':checked')) {
                        brandId += $(this).val() + ",";
                    }
                });
                $(".categoryId").each(function () {
                    if ($(this).is(':checked')) {
                        categoryId += $(this).val() + ",";
                    }
                });
                var data = {};
                data.brandIds = brandId.slice(0, brandId.length - 1);
                data.categoryIds = categoryId.slice(0, categoryId.length - 1);
                searchProducts(data);
            });
        });

        $(document).ready(function () {

            $(".categoryId").click(function () {
                //$("#preloader").css('opacity', '0.3');
                $("#preloader").css('display', 'block');
                var categoryId = "";
                var brandId = "";
                $(".brandId").each(function () {
                    if ($(this).is(':checked')) {
                        brandId += $(this).val() + ",";
                    }
                });
                $(".categoryId").each(function () {
                    if ($(this).is(':checked')) {
                        categoryId += $(this).val() + ",";
                    }
                });

                var data = {};
                data.brandIds = brandId.slice(0, brandId.length - 1);
                data.categoryIds = categoryId.slice(0, categoryId.length - 1);
                searchProducts(data);
            });
        });

        function GetDeliveryManInfo(name, email, mobile, image) {
            $("#DeliveryManDetails").empty();
            $("#DeliveryManImage").empty();
            $("#DeliveryManImage").append("<tr><td style='border:none'></td><td style='border:none;font-weight:bold'></td></tr>" +
                "<tr><td  style='border: none;'><img src=" + "@BaseUrl.baseUrl" + "/" + image + " alt='delivery-man' style='width:250px'></td>");
            $("#DeliveryManDetails").append("<tr style='height:20px'></tr><tr style='border: none'><td  style='border: none;width: 20%'>Name :</td>" +
                "<td  style='border:none'>" + name + "</td></tr>" +
                "<tr ><td style='border:none;width: 20%'>Mobile :</td>" +
                "<td  style='border:none'>" + email + "</td></tr>" +
                "<tr><td style='border:none;width: 20%'>Email :</td>" +
                "<td style='border:none'>" + mobile + "</td></tr>"
            );
        }
    </script>
    @RenderSection("scripts", required: false)
</body>
</html>
